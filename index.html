<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QU√ÅN CHAY 6 LOAN</title>
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#02a046">
    <style id="critical-css">
        /* CSS QUAN TR·ªåNG - T·∫£i ngay l·∫≠p t·ª©c ƒë·ªÉ hi·ªÉn th·ªã giao di·ªán ban ƒë·∫ßu */
		        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        .header {
            background: white;
            padding: 0.5px 6px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-title {
            font-size: 26px;
            font-weight: 600;
            color: #02a046;
            padding: 4px;
        }
        .category-tabs {
            display: flex;
            background: white;
            padding: 5px;
            gap: 8px;
            overflow-x: auto;
            border-bottom: 1px solid #e0e0e0;
        }
        .category-tab {
            padding: 7px;
            border-radius: 12px;
            border: none;
            font-size: 15px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
            background: #f0f0f0;
            color: #666;
        }
        .category-tab.active {
            background: #02a046;
            color: white;
            font-weight: 600;
        }
        .featured-banner {
            background: linear-gradient(135deg, #02a046, #02a046);
            margin: 10px 6px;
            border-radius: 15px;
            padding: 10px;
            color: white;
            position: relative;
            overflow: hidden;
        }
        .featured-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .featured-subtitle {
            font-size: 16px;
        }
        .products-container {
            padding: 6px 10px 80px;
        }
        .products-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px;
            margin-bottom: 40px;
        }
        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .product-name {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 3px;
            color: #333;
            line-height: 1.0;
            height: 24px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        .product-price {
            font-size: 22px;
            font-weight: bold;
            color: #02a046;
        }
		
		/* --- B·∫ÆT ƒê·∫¶U CSS CHO HEADER LOGO M·ªöI --- */

.header-logo-container {
    display: flex;          /* S·∫Øp x·∫øp logo v√† ch·ªØ n·∫±m ngang */
    align-items: center;    /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
    height: 40px;
    padding-left: 6px;      /* Th√™m m·ªôt ch√∫t kho·∫£ng tr·ªëng b√™n l·ªÅ tr√°i */
}

.logo-avatar {
    height: 100%;           /* Cao 45px */
    width: auto;
    aspect-ratio: 1 / 1;    /* Gi·ªØ h√¨nh vu√¥ng */
    object-fit: cover;
    border-radius: 7px;
    flex-shrink: 0;         /* Quan tr·ªçng: NgƒÉn ·∫£nh b·ªã co l·∫°i khi kh√¥ng ƒë·ªß ch·ªó */
}

/* Ch·ªânh l·∫°i class .header-title ƒë·ªÉ ho·∫°t ƒë·ªông t·ªët khi n·∫±m c·∫°nh logo */
.header-title {
    font-size: 26px;        /* C√≥ th·ªÉ ƒëi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc ch·ªØ ·ªü ƒë√¢y */
    font-weight: 600;
    color: #02a046;
    margin-left: 12px;      /* Kho·∫£ng c√°ch gi·ªØa ·∫£nh ƒë·∫°i di·ªán v√† ch·ªØ */
    padding: 0;             /* B·ªè ƒëi padding c≈© ƒë·ªÉ cƒÉn ch·ªânh t·ªët h∆°n */
}

/* --- K·∫æT TH√öC CSS CHO HEADER LOGO M·ªöI --- */

    </style>
</head>
<body>
    <div class="header">
    <div class="header-logo-container">
        <img src="https://i.postimg.cc/Sx3Vxx22/anhdaidien1.png" alt="·∫¢nh ƒë·∫°i di·ªán" class="logo-avatar">
        
        <div class="header-title">QU√ÅN CHAY 6 LOAN</div>
    </div>
</div>
    <div class="featured-banner">
        <div class="featured-title">ü•ü Ch·∫•t l∆∞·ª£ng v√† Dinh d∆∞·ª°ng</div>
        <div class="featured-subtitle">Nguy√™n li·ªáu t∆∞∆°i, M√≥n ngon nh√† n·∫•u</div>
    </div>
	<div class="category-tabs">
        <button class="category-tab active" onclick="showCategory('all', this)">T·∫•t c·∫£</button>
        <button class="category-tab" onclick="showCategory('M√≥n ƒÉn', this)">M√≥n ƒÉn</button>
        <button class="category-tab" onclick="showCategory('N∆∞·ªõc u·ªëng', this)">N∆∞·ªõc u·ªëng</button>
        <button class="category-tab" onclick="showCategory('H·∫øt h√†ng', this)">H·∫øt h√†ng</button>
    </div>
    
    <div class="products-container">
        <div class="products-grid store-closed" id="productsGrid">
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/qBsZbvJv/Hu-Tiu-Chay.webp" alt="H·ªß t√≠u Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">H·ªß t√≠u Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('H·ªß t√≠u Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('H·ªß t√≠u Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('H·ªß t√≠u Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/bY930Vgs/BunBo.webp" alt="B√∫n b√≤ Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">B√∫n b√≤ Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('B√∫n b√≤ Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('B√∫n b√≤ Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('B√∫n b√≤ Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/W1CnpBN8/BunRieu.webp" alt="B√∫n ri√™u Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">B√∫n ri√™u Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('B√∫n ri√™u Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('B√∫n ri√™u Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('B√∫n ri√™u Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/fLhfmY02/Banhcanh-Chay.webp" alt="B√°nh canh Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">B√°nh canh Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('B√°nh canh Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('B√°nh canh Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('B√°nh canh Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/m2rNYLhm/BunThai.webp" alt="B√∫n Th√°i Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">B√∫n Th√°i Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('B√∫n Th√°i Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('B√∫n Th√°i Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('B√∫n Th√°i Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/KYtnG4sK/Bun-Xao-Chay.webp" alt="B√∫n x√†o Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">B√∫n x√†o Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('B√∫n x√†o Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('B√∫n x√†o Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('B√∫n x√†o Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/9XLyF61L/Bunmang.webp" alt="B√∫n mƒÉng Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">B√∫n mƒÉng Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('B√∫n mƒÉng Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('B√∫n mƒÉng Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('B√∫n mƒÉng Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/PqnwRTrk/Hoanh-Thanh.webp" alt="Ho√†nh th√°nh Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">Ho√†nh th√°nh Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('Ho√†nh th√°nh Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('Ho√†nh th√°nh Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('Ho√†nh th√°nh Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/SsyzmdM1/Bunmam-Chay.webp" alt="B√∫n m·∫Øm Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">B√∫n m·∫Øm Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('B√∫n m·∫Øm Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('B√∫n m·∫Øm Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('B√∫n m·∫Øm Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="M√≥n ƒÉn" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/qBsZbvJv/Hu-Tiu-Chay.webp" alt="M√¨ Chay" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">M√¨ Chay</div>
                    <div class="product-footer">
                        <div class="product-price">25.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('M√¨ Chay', 25000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('M√¨ Chay', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('M√¨ Chay', 25000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="N∆∞·ªõc u·ªëng" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/tC1nRYsb/NuocSam.webp" alt="N∆∞·ªõc S√¢m" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">N∆∞·ªõc S√¢m</div>
                    <div class="product-footer">
                        <div class="product-price">5.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('N∆∞·ªõc S√¢m', 5000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('N∆∞·ªõc S√¢m', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('N∆∞·ªõc S√¢m', 8000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="N∆∞·ªõc u·ªëng" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/cHg6xzJ9/SuongSa.webp" alt="S∆∞∆°ng Sa H·∫°t √â" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">S∆∞∆°ng Sa H·∫°t √â</div>
                    <div class="product-footer">
                        <div class="product-price">5.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('S∆∞∆°ng Sa H·∫°t √â', 5000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('S∆∞∆°ng Sa H·∫°t √â', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('S∆∞∆°ng Sa H·∫°t √â', 8000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="N∆∞·ªõc u·ªëng" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/QN7Vvvwj/TiaTo.webp" alt="N∆∞·ªõc T√≠a T√¥" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">N∆∞·ªõc T√≠a T√¥</div>
                    <div class="product-footer">
                        <div class="product-price">5000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('N∆∞·ªõc T√≠a T√¥', 5000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('N∆∞·ªõc T√≠a T√¥', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('N∆∞·ªõc T√≠a T√¥', 8000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-card" data-category="N∆∞·ªõc u·ªëng" data-status="ƒêang b√°n">
                <div class="product-image"><img src="https://i.postimg.cc/bNHrwkzd/Nhadam.webp" alt="N∆∞·ªõc Nha ƒêam" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy"></div>
                <div class="product-info">
                    <div class="product-name">N∆∞·ªõc Nha ƒêam</div>
                    <div class="product-footer">
                        <div class="product-price">5.000</div>
                        <div class="product-controls">
                            <button class="add-btn" onclick="addToCart('N∆∞·ªõc Nha ƒêam', 5000, this)">+</button>
                            <div class="quantity-controls"><button class="quantity-btn" onclick="decreaseQuantityOnCard('N∆∞·ªõc Nha ƒêam', this)">-</button><span class="quantity-display">1</span><button class="quantity-btn increase" onclick="increaseQuantityOnCard('N∆∞·ªõc Nha ƒêam', 8000, this)">+</button></div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
    <div class="cart-summary" id="cartSummary">
        <div class="cart-summary-left">
            <div class="cart-items-count" id="cartItemsCount">2 m√≥n</div>
            <div class="cart-total-price" id="cartTotalPrice">150.000</div>
        </div>
        <button class="view-cart-btn" onclick="showCart()">Xem m√≥n ƒë√£ ch·ªçn</button>
    </div>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div>ƒêang x·ª≠ l√Ω ƒë∆°n h√†ng...</div>
        </div>
    </div>
    <div class="cart-modal" id="cartModal">
        <div class="cart-modal-content">
            <div class="cart-modal-header">
                <div class="cart-modal-title">TH√îNG TIN ƒê∆†N H√ÄNG</div>
            </div>
            <div class="cart-modal-body" id="cartModalBody">
            </div>
            <div class="cart-modal-footer">
                <div class="order-buttons" id="orderButtons">
                    <button class="back-to-menu-btn" onclick="backToMenu()">‚Üê ƒê·∫∑t th√™m m√≥n kh√°c</button>
                    <div class="cart-total">
                        <span>T·ªïng c·ªông:&nbsp; </span>
                        <span id="modalTotalPrice">0 </span>
                    </div>
                    <button class="order-btn" id="onlineOrderBtn" onclick="showOrderForm()">B·∫ÆT ƒê·∫¶U ƒê·∫∂T M√ìN</button>
                </div>
                <div class="order-form" id="orderForm">
                    <form onsubmit="submitOrder(event)" id="orderFormElement">
                        <div class="form-group">
                            <input type="text" class="form-input" id="customerName" name="customerName" required minlength="3" placeholder=" ">
                            <label class="form-label" for="customerName">T√™n kh√°ch h√†ng</label>
                            <div class="error-message" id="nameError">T√™n kh√°ch h√†ng ph·∫£i c√≥ √≠t nh·∫•t 3 k√Ω t·ª±</div>
                        </div>
                        <div class="form-group">
                            <input type="tel" class="form-input" id="customerPhone" name="customerPhone" required pattern="^(0[35789])[0-9]{8}$" placeholder=" ">
                            <label class="form-label" for="customerPhone">S·ªë ƒëi·ªán tho·∫°i</label>
                            <div class="error-message" id="phoneError">Vui l√≤ng nh·∫≠p ƒë√∫ng ƒë·ªãnh d·∫°ng s·ªë di ƒë·ªông Vi·ªát Nam</div>
                        </div>
                        
                        <div class="form-group">
						<div class="form-group">
                            <div class="address-input-group">
                                <input type="text" class="form-input" id="address" name="address"  required minlength="10" placeholder=" ">
                                <label class="form-label" for="address">S·ªë nh√†, T√™n ƒë∆∞·ªùng, ·∫§p/Khu ph·ªë</label>
							<div class="error-message" id="addressError">Vui l√≤ng nh·∫≠p: S·ªë nh√†, T√™n ƒë∆∞·ªùng,  ·∫§p/Khu ph·ªë</div>	
                                
                            </div>
                        </div>
                            <div class="custom-select-wrapper address-input-group">
                                <input type="text" class="form-input" id="ward" name="ward" required readonly placeholder=" " onclick="toggleWardDropdown()">
                                <label class="form-label" for="ward">Ph∆∞·ªùng/X√£</label>
                                <div class="custom-dropdown" id="wardDropdown">
                                    <div class="dropdown-group">
                                        <div class="dropdown-group-label">Huy·ªán H√≥c M√¥n</div>
                                       
                                        <div class="dropdown-option" onclick="selectWard('X√£ H√≥c M√¥n')">X√£ H√≥c M√¥n (TT H√≥c M√¥n + T√¢n Xu√¢n + T√¢n Hi·ªáp)</div>
                                        <div class="dropdown-option" onclick="selectWard('X√£ Xu√¢n Th·ªõi S∆°n')">X√£ Xu√¢n Th·ªõi S∆°n (T√¢n Th·ªõi Nh√¨ + Xu√¢n Th·ªõi ƒê√¥ng + Xu√¢n Th·ªõi S∆°n)</div>
                                        <div class="dropdown-option" onclick="selectWard('X√£ ƒê√¥ng Th·∫°nh')">X√£ ƒê√¥ng Th·∫°nh (Th·ªõi Tam Th√¥n + Nh·ªã B√¨nh + ƒê√¥ng Th·∫°nh)</div>
										<div class="dropdown-option" onclick="selectWard('X√£ B√† ƒêi·ªÉm')">X√£ B√† ƒêi·ªÉm (Xu√¢n Th·ªõi Th∆∞·ª£ng + Trung Ch√°nh + B√† ƒêi·ªÉm)</div>
                                    </div>
                                    <div class="dropdown-group">
                                        <div class="dropdown-group-label">Qu·∫≠n 12</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng ƒê√¥ng H∆∞ng Thu·∫≠n')">Ph∆∞·ªùng ƒê√¥ng H∆∞ng Thu·∫≠n (T√¢n Th·ªõi Nh·∫•t + T√¢n H∆∞ng Thu·∫≠n + ƒê√¥ng H∆∞ng Thu·∫≠n)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng Trung M·ªπ T√¢y')">Ph∆∞·ªùng Trung M·ªπ T√¢y (Trung M·ªπ T√¢y + T√¢n Ch√°nh Hi·ªáp)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng T√¢n Th·ªõi Hi·ªáp')">Ph∆∞·ªùng T√¢n Th·ªõi Hi·ªáp (Hi·ªáp Th√†nh + T√¢n Th·ªõi Hi·ªáp)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng Th·ªõi An')">Ph∆∞·ªùng Th·ªõi An (Th·ªõi An + Th·∫°nh Xu√¢n)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng An Ph√∫ ƒê√¥ng')">Ph∆∞·ªùng An Ph√∫ ƒê√¥ng (An Ph√∫ ƒê√¥ng + Th·∫°nh L·ªôc)</div>
                                    </div>
                                    <div class="dropdown-group">
                                        <div class="dropdown-group-label">Qu·∫≠n G√≤ V·∫•p</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng H·∫°nh Th√¥ng')">Ph∆∞·ªùng H·∫°nh Th√¥ng (P.1 + P.3)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng An Nh∆°n')">Ph∆∞·ªùng An Nh∆°n (P.5 + P.6)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng G√≤ V·∫•p')">Ph∆∞·ªùng G√≤ V·∫•p (P.10 + P.17)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng Th·ªëng T√¢y H·ªôi')">Ph∆∞·ªùng Th·ªëng T√¢y H·ªôi (P8 + P.11)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng An H·ªôi T√¢y')">Ph∆∞·ªùng An H·ªôi T√¢y (P.12 + P.14)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng An H·ªôi ƒê√¥ng')">Ph∆∞·ªùng An H·ªôi ƒê√¥ng (P.15 + P.16)</div>
                                    </div>
                                    <div class="dropdown-group">
                                        <div class="dropdown-group-label">Qu·∫≠n T√¢n B√¨nh</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng T√¢n S∆°n H√≤a')">Ph∆∞·ªùng T√¢n S∆°n H√≤a (P.1 + P.2 + P.3)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng T√¢n S∆°n Nh·∫•t')">Ph∆∞·ªùng T√¢n S∆°n Nh·∫•t (P.4 + P.5 + P.7)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng T√¢n H√≤a')">Ph∆∞·ªùng T√¢n H√≤a (P.6 + P.8 + P.9)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng B·∫£y Hi·ªÅn')">Ph∆∞·ªùng B·∫£y Hi·ªÅn (P.10 + P.11 + P.12)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng T√¢n B√¨nh')">Ph∆∞·ªùng T√¢n B√¨nh (P.13 + P.14 + 1 ph·∫ßn P.15)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng T√¢n S∆°n')">Ph∆∞·ªùng T√¢n S∆°n (Ph·∫ßn c√≤n l·∫°i c·ªßa Ph∆∞·ªùng 15)</div>
                                    </div>
                                    <div class="dropdown-group">
                                        <div class="dropdown-group-label">Qu·∫≠n T√¢n Ph√∫</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng T√¢y Th·∫°nh')">Ph∆∞·ªùng T√¢y Th·∫°nh (T√¢y Th·∫°nh + m·ªôt ph·∫ßn S∆°n K·ª≥)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng T√¢n S∆°n Nh√¨')">Ph∆∞·ªùng T√¢n S∆°n Nh√¨ (T√¢n S∆°n Nh√¨ + 1 ph·∫ßn S∆°n K·ª≥ + 1 ph·∫ßn T√¢n Qu√Ω + 1 ph·∫ßn T√¢n Th√†nh)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng Ph√∫ Th·ªç H√≤a')">Ph∆∞·ªùng Ph√∫ Th·ªç H√≤a (Ph√∫ Th·ªç H√≤a + 1 ph·∫ßn T√¢n Th√†nh + 1 l·∫°i T√¢n Qu√Ω)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng Ph√∫ Th·∫°nh')">Ph∆∞·ªùng Ph√∫ Th·∫°nh (Hi·ªáp T√¢n + Ph√∫ Th·∫°nh + 1 ph·∫ßn T√¢n Th·ªõi H√≤a)</div>
                                        <div class="dropdown-option" onclick="selectWard('Ph∆∞·ªùng T√¢n Ph√∫')">Ph∆∞·ªùng T√¢n Ph√∫ (Ph√∫ Trung + H√≤a Th·∫°nh + 1 ph·∫ßn T√¢n Th·ªõi H√≤a + 1 ph·∫ßn T√¢n Th√†nh)</div>
                                    </div>
                                    <div class="dropdown-group">
                                        <div class="dropdown-group-label">Huy·ªán C·ªß Chi</div>
                                        <div class="dropdown-option" onclick="selectWard('X√£ An Nh∆°n T√¢y')">X√£ An Nh∆°n T√¢y (h√∫ M·ªπ H∆∞ng + An Ph√∫ + An Nh∆°n T√¢y)</div>
                                        <div class="dropdown-option" onclick="selectWard('X√£ Th√°i M·ªπ')">X√£ Th√°i M·ªπ (Trung L·∫≠p Th∆∞·ª£ng + Ph∆∞·ªõc Th·∫°nh + Th√°i M·ªπ)</div>
                                        <div class="dropdown-option" onclick="selectWard('X√£ Nhu·∫≠n ƒê·ª©c')">X√£ Nhu·∫≠n ƒê·ª©c (Ph·∫°m VƒÉn C·ªôi + Trung L·∫≠p H·∫° + Nhu·∫≠n ƒê·ª©c)</div>
                                        <div class="dropdown-option" onclick="selectWard('X√£ T√¢n An H·ªôi')">X√£ T√¢n An H·ªôi (Th·ªã tr·∫•n C·ªß Chi + Ph∆∞·ªõc Hi·ªáp + T√¢n An H·ªôi)</div>
                                        <div class="dropdown-option" onclick="selectWard('X√£ C·ªß Chi')">X√£ C·ªß Chi (T√¢n Ph√∫ Trung + T√¢n Th√¥ng H·ªôi + Ph∆∞·ªõc Vƒ©nh An)</div>
                                        <div class="dropdown-option" onclick="selectWard('X√£ Ph√∫ H√≤a ƒê√¥ng')">X√£ Ph√∫ H√≤a ƒê√¥ng (T√¢n Th·∫°nh T√¢y + T√¢n Th·∫°nh ƒê√¥ng + Ph√∫ H√≤a ƒê√¥ng)</div>
                                        <div class="dropdown-option" onclick="selectWard('X√£ B√¨nh M·ªπ')">X√£ B√¨nh M·ªπ (B√¨nh M·ªπ + H√≤a Ph√∫ + Trung An)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
						<div class="form-group">
                            <input type="text" class="form-input" id="city" name="city" value="Tp.H·ªì Ch√≠ Minh" readonly placeholder=" ">
                             <label class="form-label" for="city">T·ªânh/Th√†nh ph·ªë</label>
                        </div>
                        <div class="form-group">
                            <textarea class="form-textarea" id="note" name="note" placeholder=" "></textarea>
                            <label class="form-label" for="note">Ghi ch√∫ th√™m (n·∫øu c√≥)</label>
                        </div>
                        <button type="submit" class="submit-btn">X√ÅC NH·∫¨N ƒê·∫∂T M√ìN</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
	
	<div class="admin-popup" id="adminPopup" role="dialog" aria-modal="true" aria-labelledby="adminTitle">
        <div class="admin-popup-content">
            <div class="admin-header">
                <h2 id="adminTitle">TH√îNG TIN QU√ÅN ƒÇN</h2>
                <button onclick="closeAdminPopup()" aria-label="ƒê√≥ng">‚úñ</button>
            </div>
            <div class="admin-body">

                <div class="management-section" style="margin-top: 0;">
                    <details open id="adminShopInfoSection">
                        <summary>QU√ÅN CHAY 6 LOAN</summary>
                        <div class="details-content">
                            <div class="admin-shop-info-item" id="adminShopOpeningHours"><strong>Gi·ªù m·ªü c·ª≠a:</strong> ƒêang t·∫£i...</div>
                            <div class="admin-shop-info-item"><strong>ƒê·ªãa ch·ªâ:</strong> <span style="color: #02a046; font-weight: 600;">126/1 L√™ L·ª£i, X√£ H√≥c M√¥n, Tp.HCM</span></div>
                            <div class="admin-shop-info-item"><strong>V·ªã tr√≠:</strong> <a href="https://share.google/V4UeWTN1GKdJRFruY" target="_blank">Xem tr√™n Google Maps</a></div>
                            <div class="admin-shop-info-item"><strong>ƒêi·ªán tho·∫°i:</strong> <a href="tel:0779957366">0779957366</a></div>
                            <div class="admin-shop-info-item"><strong>Zalo:</strong> <a href="https://zalo.me/0763137082" target="_blank">K·∫øt b·∫°n Zalo</a></div>
                        </div>
                    </details>
                </div>
    
                <div id="adminGrid" class="admin-grid">
                    <div class="admin-card" onclick="showManagerView('orderManager')">
                        <div class="admin-card-icon">üìã</div>
                        <div class="admin-card-title">Qu·∫£n l√Ω ƒê∆°n H√†ng</div>
                    </div>
                    <div class="admin-card" onclick="showManagerView('menuManager')">
                        <div class="admin-card-icon">üìñ</div>
                        <div class="admin-card-title">Qu·∫£n l√Ω Menu</div>
                    </div>
                    <div class="admin-card" onclick="showManagerView('storeHoursManager')">
                        <div class="admin-card-icon">‚è∞</div>
                        <div class="admin-card-title">Gi·ªù Ho·∫°t ƒê·ªông</div>
                    </div>
                    <div class="admin-card" onclick="changePassword()">
                        <div class="admin-card-icon">üîë</div>
                        <div class="admin-card-title">ƒê·ªïi M·∫≠t Kh·∫©u</div>
                    </div>
                </div>
    
                <div id="managementViews">
                    <div id="orderManager" class="management-view">
                        <button class="back-to-grid-btn" onclick="history.back()">‚Üê Quay l·∫°i</button>
                        <div class="management-section">
                            <details open>
                                <summary>Qu·∫£n l√Ω ƒê∆†N H√ÄNG</summary>
                                <div class="details-content">
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 2px; margin-bottom: 0px; margin-bottom: 0px;">
                                        <div id="orderAlert" class="admin-alert info">ƒêang ch·ªù t·∫£i ƒë∆°n h√†ng...</div>
                                        <button style="background: #e8f5e9; color: #02a046; border: 1px solid #a5d6a7; border-radius: 8px; padding: 6px 10px; cursor: pointer; font-size: 13px;" onclick="fetchPendingOrders()">T·∫£i l·∫°i</button>
                                    </div>
                                    <div id="adminOrderList" style="max-height: 68vh; overflow-y: auto; padding-right: 5px;"></div>
                                </div>
                            </details>
                        </div>
                    </div>
        
                    <div id="menuManager" class="management-view">
                        <button class="back-to-grid-btn" onclick="history.back()">‚Üê Quay l·∫°i</button>
                        <div class="management-section">
                             <details open>
                                <summary>Qu·∫£n l√Ω MENU</summary>
                                <div class="details-content">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <input type="search" id="menuSearch" placeholder="T√¨m m√≥n..." style="width: calc(100% - 100px); padding: 8px 10px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px;" oninput="renderAdminMenuList()" />
                                        <button style="background: #e8f5e9; color: #02a046; border: 1px solid #a5d6a7; border-radius: 8px; padding: 6px 10px; cursor: pointer; font-size: 13px;" onclick="fetchAdminMenu()">T·∫£i l·∫°i</button>
                                    </div>
                                    <div id="loadAlert" class="admin-alert"></div>
                                    <div id="adminMenuList" style="max-height: 60vh; overflow-y: auto;"></div>
                                </div>
                            </details>
                        </div>
                    </div>
        
                    <div id="storeHoursManager" class="management-view">
                        <button class="back-to-grid-btn" onclick="history.back()">‚Üê Quay l·∫°i</button>
                        <div class="management-section">
                             <details open>
                                <summary>Qu·∫£n l√Ω GI·ªú HO·∫†T ƒê·ªòNG</summary>
                                <div class="details-content">
                                    <div id="storeHoursAlert" class="admin-alert"></div>
                                    <div class="hours-section">
                                        <h4 style="margin: 0 0 10px 0; color: #333;">1. Gi·ªù ho·∫°t ƒë·ªông TH√îNG TH∆Ø·ªúNG</h4>
                                        <div id="normalHoursList"></div>
                                    </div>
                                    <div class="hours-section" style="margin-top: 12x;">
                                        <h4 style="margin: 0 0 6px 0; color: #333;">2. Ch·ªçn ng√†y T·∫†M NGH·ªà</h4>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 8px;">
                                            <div>
                                                <label style="font-size: 12px; font-weight: 600; color: #333;">T·ª´ ng√†y:</label>
                                                <input type="date" id="breakStartDate" class="form-input" style="padding: 6px; margin-top: 3px;">
                                            </div>
                                            <div>
                                                <label style="font-size: 12px; font-weight: 600; color: #333;">ƒê·∫øn ng√†y:</label>
                                                <input type="date" id="breakEndDate" class="form-input" style="padding: 6px; margin-top: 3px;">
                                            </div>
                                        </div>
                                        <input type="text" id="breakReason" class="form-input" placeholder="L√Ω do t·∫°m ngh·ªâ " style="margin-bottom: 8px; padding: 5px;">
                                        <button style="background: #fff3cd; color: #02a046; border: 1px solid #ffeeba; border-radius: 8px; padding: 6px 10px; cursor: pointer; font-size: 13px; width: 100%;" onclick="addBreakPeriod()">+ Th√™m L·ªãch Ngh·ªâ</button>
                                        <div id="currentBreaks" style="margin-top: 8px; max-height: 15vh; overflow-y: auto;"></div>
                                    </div>
                                    <div style="margin-top: 10px; text-align: center;">
                                        <button class="submit-btn" onclick="saveStoreHours()" style="width: 60%; background: #02a046;"> C·∫≠p nh·∫≠t GI·ªú HO·∫†T ƒê·ªòNG </button>
                                    </div>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<div class="custom-alert order-success-popup" id="customAlert">
    <div class="custom-alert-content">
        <div class="custom-alert-header" id="alertTitle">ƒê·∫∂T H√ÄNG TH√ÄNH C√îNG !</div>
        <div class="custom-alert-body" id="alertMessage">
            <div class="success-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" style="width: 100%; height: auto;">
                    <path fill="none" stroke="currentColor" stroke-width="5" stroke-linecap="round" stroke-linejoin="round" d="M14 27l10 10L44 17"/>
                </svg>
            </div>
            <div class="success-message">C·∫£m ∆°n Qu√Ω kh√°ch ƒë√£ ƒë·∫∑t h√†ng !</div>
            <div class="success-submessage">Ch√∫ng t√¥i s·∫Ω li√™n h·ªá x√°c nh·∫≠n trong √≠t ph√∫t.</div>
            <div class="order-timestamp" id="order-time"></div>

            <div class="order-summary-section">
                <div class="section-title">üë§ Th√¥ng tin ƒë∆°n h√†ng</div>
                <div class="info-item">
                    <p><strong>Kh√°ch h√†ng:</strong> <span id="recap-customerName"></span></p>
                    <p><strong>ƒêi·ªán tho·∫°i:</strong> <span id="recap-customerPhone"></span></p>
                    <p><strong>ƒê·ªãa ch·ªâ:</strong> <span id="recap-address"></span></p>
                    <p id="recap-note-wrapper" style="display: none;"><strong>Ghi ch√∫:</strong> <span id="recap-note"></span></p>
                </div>
            </div>

            <div class="order-summary-section">
                <div class="section-title">üìã Chi ti·∫øt m√≥n ƒÉn</div>
                <div class="order-items-recap" id="recap-items">
                </div>
            </div>

             <div class="total-recap">
                <span class="total-recap-label">T·ªîNG C·ªòNG:</span>
                <span class="total-recap-value" id="recap-total"></span>
             </div>

        </div>
        <div class="custom-alert-footer">
            <button class="custom-alert-btn btn-secondary" onclick="closeCustomAlert()">ƒê√≥ng v√† Ch·ªù x√°c nh·∫≠n</button>
            <button class="custom-alert-btn btn-primary" onclick="confirmZaloOrder()">K·∫øt b·∫°n Zalo v·ªõi Qu√°n</button>
        </div>
    </div>
</div>


<div class="password-prompt" id="passwordPrompt">
    <div class="password-prompt-content">
        <div class="password-prompt-title">Y√™u c·∫ßu x√°c th·ª±c</div>
        <div class="password-prompt-subtitle">Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u qu·∫£n l√Ω</div>
        <div class="password-inputs" id="passwordInputs">
            <input type="number" inputmode="numeric" pattern="[0-9]*" maxlength="1" class="password-digit">
            <input type="number" inputmode="numeric" pattern="[0-9]*" maxlength="1" class="password-digit">
            <input type="number" inputmode="numeric" pattern="[0-9]*" maxlength="1" class="password-digit">
            <input type="number" inputmode="numeric" pattern="[0-9]*" maxlength="1" class="password-digit">
        </div>
        <button class="password-close-btn" onclick="closePasswordPrompt()">H·ªßy</button>
    </div>
</div>
<div class="password-prompt" id="newPasswordPrompt" style="display: none;">
    <div class="password-prompt-content">
        <div class="password-prompt-title">Nh·∫≠p m·∫≠t kh·∫©u m·ªõi</div>
        <div class="password-prompt-subtitle">Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u m·ªõi (4 s·ªë)</div>
        <div class="password-inputs" id="newPasswordInputs">
            <input type="number" inputmode="numeric" pattern="[0-9]*" maxlength="1" class="password-digit">
            <input type="number" inputmode="numeric" pattern="[0-9]*" maxlength="1" class="password-digit">
            <input type="number" inputmode="numeric" pattern="[0-9]*" maxlength="1" class="password-digit">
            <input type="number" inputmode="numeric" pattern="[0-9]*" maxlength="1" class="password-digit">
        </div>
        <button class="password-close-btn" onclick="closeNewPasswordPrompt()">H·ªßy</button>
    </div>
</div>
<div class="bottom-nav">
    <div class="nav-item" onclick="addToHomeScreen()">
        <div class="nav-icon">‚ûï</div>
        <div class="nav-text">L∆∞u l·∫°i</div>
    </div>

    <div class="nav-item" onclick="openZaloFromNav()">
        <div class="nav-icon">üí¨</div>
        <div class="nav-text">Chat Zalo</div>
    </div>

    <div class="nav-item" onclick="showCart()">
        <div class="nav-icon" style="position: relative;">
            üõí <span class="cart-badge" id="cartBadge">0</span>
        </div>
        <div class="nav-text">Gi·ªè h√†ng</div>
    </div>

    <div class="nav-item" onclick="window.location.href='tel:0779957366'">
        <div class="nav-icon">üìû</div>
        <div class="nav-text">G·ªçi ƒëi·ªán</div>
    </div>

    <div class="nav-item" onclick="openAdminPopup()">
        <div class="nav-icon">üè™</div>
        <div class="nav-text">Xem Th√™m</div>
    </div>
</div>
<div class="store-status-popup" id="storeStatusPopup">
    <div class="store-status-content">
        <div class="store-status-icon">üè™</div>
        <div class="store-status-title" id="storeStatusTitle">Qu√°n ƒëang ƒë√≥ng c·ª≠a</div>
        <div class="store-status-message" id="storeStatusMessage">
            Qu√°n s·∫Ω m·ªü c·ª≠a l·∫°i v√†o 06:00
        </div>
        <button class="store-status-btn" onclick="closeStoreStatusPopup()">ƒê√£ hi·ªÉu</button>
    </div>
</div>

<script defer>
    const urlParams = new URLSearchParams(window.location.search);
const isOfflineMode = urlParams.get('mode') === 'offline';
const tableInfo = urlParams.get('table');
const PREDEFINED_NOTES = [
    'Rau Tr·ª•ng',
	'Rau S·ªëng',
	'Kh√¥ng H√†nh',
    'Kh√¥ng Gi√°', 
	'Kh√¥ng Qu·∫ø',
    'Nhi·ªÅu B√∫n',
    'Nhi·ªÅu N·∫•m',
    'Nhi·ªÅu N∆∞·ªõc',
    'Kh√¥ng Tr·ª•ng',
    'Kh√°c...' // T√πy ch·ªçn ƒë·ªÉ nh·∫≠p tay
];

    // === PH·∫¶N S·ª¨A L·ªñI QUAN TR·ªåNG NH·∫§T ===
    // Khai b√°o r√µ r√†ng 2 link cho 2 m·ª•c ƒë√≠ch kh√°c nhau
    const SCRIPT_URLS = {
        onlineOrder: 'https://script.google.com/macros/s/AKfycbydXimgEdx-FZGYwVIDAFTBxfSKH4UpQOs4WT-aVU2NFiPnQNq4WFJISPHN8fM8HpPK8w/exec', // Link C≈® cho ƒë∆°n Online
        offlineOrder: 'https://script.google.com/macros/s/AKfycbz0kwAmsEejvJRTdr8Wt5ya44kn7cfRrLSgI9bJZV36kuXO5uRpKHn9yKNEzR81Tjs3lA/exec', // Link M·ªöI cho ƒë∆°n Offline
        menu: 'https://script.google.com/macros/s/AKfycbzIlA3lho8TgEeKeiZWLJPsc1kkmyRxSgNoNQTTQD-S8wyRJEffBp8X0PnM66I5f85UwA/exec',
        storeHours: 'https://script.google.com/macros/s/AKfycbyrHVX8PfGNgblZh6NfTbyOo2dRTdOhVyC_PMmZXS5MvuxyunC7FyqSs8qWcR5kL1VG/exec'
    };
    // =======================================

    const MENU_SCRIPT_URL = SCRIPT_URLS.menu;
    
    const PRODUCT_IMAGES = {
        'H·ªß t√≠u Chay': 'https://i.postimg.cc/qBsZbvJv/Hu-Tiu-Chay.webp',
        'B√∫n b√≤ Chay': 'https://i.postimg.cc/bY930Vgs/BunBo.webp', 
        'B√∫n ri√™u Chay': 'https://i.postimg.cc/W1CnpBN8/BunRieu.webp',
        'B√°nh canh Chay': 'https://i.postimg.cc/fLhfmY02/Banhcanh-Chay.webp',
        'B√∫n Th√°i Chay': 'https://i.postimg.cc/m2rNYLhm/BunThai.webp',
        'B√∫n x√†o Chay': 'https://i.postimg.cc/KYtnG4sK/Bun-Xao-Chay.webp',
        'B√∫n mƒÉng Chay': 'https://i.postimg.cc/9XLyF61L/Bunmang.webp',
        'Ho√†nh th√°nh Chay': 'https://i.postimg.cc/PqnwRTrk/Hoanh-Thanh.webp',
        'B√∫n m·∫Øm Chay': 'https://i.postimg.cc/SsyzmdM1/Bunmam-Chay.webp',
        'M√¨ Chay': 'https://i.postimg.cc/qBsZbvJv/Hu-Tiu-Chay.webp',
        'N∆∞·ªõc S√¢m': 'https://i.postimg.cc/tC1nRYsb/NuocSam.webp',
        'N∆∞·ªõc T√≠a T√¥': 'https://i.postimg.cc/QN7Vvvwj/TiaTo.webp', 
        'S∆∞∆°ng Sa H·∫°t √â': 'https://i.postimg.cc/cHg6xzJ9/SuongSa.webp',
        'N∆∞·ªõc Nha ƒêam': 'https://i.postimg.cc/bNHrwkzd/Nhadam.webp'
    };
    let menuData = [];
    let cartCount = 0;
    let cartItems = [];
    let cartTotal = 0;
    let isStoreOpen = false; 
    
    function validateName() {
        const nameInput = document.getElementById('customerName');
        const nameError = document.getElementById('nameError');
        const name = nameInput.value.trim();
        if (name.length < 3) {
            nameInput.classList.add('error');
            nameError.style.display = 'block';
            return false;
        } else {
            nameInput.classList.remove('error');
            nameError.style.display = 'none';
            return true;
        }
    }
    function validatePhone() {
        const phoneInput = document.getElementById('customerPhone');
        const phoneError = document.getElementById('phoneError');
        const phone = phoneInput.value.trim();
        const vnMobilePattern = /^(0[35789])[0-9]{8}$/;
        if (!vnMobilePattern.test(phone)) {
            phoneInput.classList.add('error');
            phoneError.style.display = 'block';
            return false;
        } else {
            phoneInput.classList.remove('error');
            phoneError.style.display = 'none';
            return true;
        }
    }
    
    function validateAddress() {
      const addressInput = document.getElementById('address');
      const addressError = document.getElementById('addressError');
      const value = (addressInput.value || '').trim();

      if (value.length < 10) {
        addressInput.classList.add('error');
        addressError.style.display = 'block';
        return false;
      } else {
        addressInput.classList.remove('error');
        addressError.style.display = 'none';
        return true;
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
        // T·∫¢I MENU ƒê·ªòNG CHO C·∫¢ ONLINE V√Ä OFFLINE
        loadMenuFromSheets(); 
               
        const nameInput = document.getElementById('customerName');
        const phoneInput = document.getElementById('customerPhone');
        const addressInput = document.getElementById('address');
        if (nameInput) {
            nameInput.addEventListener('input', validateName);
            nameInput.addEventListener('blur', validateName);
            nameInput.addEventListener('input', function () {
                this.value = this.value.toUpperCase();
            });
        }
        if (phoneInput) {
            phoneInput.addEventListener('input', validatePhone);
            phoneInput.addEventListener('blur', validatePhone);
        }
        if (addressInput) {
            addressInput.addEventListener('input', validateAddress);
            addressInput.addEventListener('blur', validateAddress);
            addressInput.addEventListener("blur", () => {
                const formatted = smartFormatAddress(addressInput.value);
                if (formatted) addressInput.value = formatted;
            });
        }
        
        loadStoreHoursForCheck();
        setupPasswordInputListeners();
        setupNewPasswordInputListeners();
        history.replaceState({view: 'home'}, 'Trang ch·ªß', window.location.pathname);

        if (isOfflineMode) {
            document.getElementById('orderForm').style.display = 'none';
			// ·∫®n banner qu·∫£ng c√°o khi ·ªü ch·∫ø ƒë·ªô offline
const featuredBanner = document.querySelector('.featured-banner');
if (featuredBanner) {
    featuredBanner.style.display = 'none';
}
           // ·∫®n thanh ƒëi·ªÅu h∆∞·ªõng cu·ªëi trang (v·ªõi !important)
            const bottomNav = document.querySelector('.bottom-nav');
            if (bottomNav) {
                bottomNav.style.setProperty('display', 'none', 'important');
            }
			// ƒê·∫©y cart-summary xu·ªëng s√°t m√©p d∆∞·ªõi
            const cartSummary = document.getElementById('cartSummary');
            if (cartSummary) {
                cartSummary.style.bottom = '5px'; 
            }
			// Di chuy·ªÉn ch√¢n gi·ªè h√†ng (cart-modal-footer) xu·ªëng d∆∞·ªõi
            const cartModalFooter = document.querySelector('.cart-modal-footer');
            if (cartModalFooter) {
                cartModalFooter.style.position = 'fixed';
                cartModalFooter.style.bottom = '5px';
                cartModalFooter.style.left = '0';
                cartModalFooter.style.right = '0';
                cartModalFooter.style.background = 'white'; // Th√™m n·ªÅn tr·∫Øng ƒë·ªÉ kh√¥ng b·ªã trong su·ªët
                cartModalFooter.style.padding = '10px 10px 5px 10px'; // Ch·ªânh l·∫°i padding cho ƒë·∫πp h∆°n
            }
            const orderBtn = document.getElementById('onlineOrderBtn');
            if(orderBtn){
                orderBtn.textContent = 'G·ª¨I ƒê·∫æN B·∫æP';
                orderBtn.onclick = (event) => {
                    event.preventDefault();
                    submitOfflineOrder();
                };
            }
             // ·∫®n c√°c n√∫t kh√¥ng c·∫ßn thi·∫øt trong khu v·ª±c qu·∫£n l√Ω khi OFFLINE
            const orderManagerCard = document.querySelector('.admin-card[onclick="showManagerView(\'orderManager\')"]');
            const storeHoursCard = document.querySelector('.admin-card[onclick="showManagerView(\'storeHoursManager\')"]');
            if(orderManagerCard) orderManagerCard.style.display = 'none';
            if(storeHoursCard) storeHoursCard.style.display = 'none';
        }
    });		
    
   
    function showCategory(category, button) {
        document.querySelectorAll('.category-tab').forEach(tab => tab.classList.remove('active'));
        button.classList.add('active');

        document.querySelectorAll('.product-card').forEach(card => {
            const cardCategory = card.getAttribute('data-category');
            const cardStatus = card.getAttribute('data-status');
            let isVisible = false;

            if (category === 'all') {
                isVisible = true;
            } else if (category === 'H·∫øt h√†ng') {
                isVisible = (cardStatus === 'H·∫øt h√†ng');
            } else {
                isVisible = (cardCategory === category);
            }
            
            card.style.display = isVisible ? 'block' : 'none';
        });
    }

    function addToCart(productName, price, button) {
        const productControls = button.parentElement;
        const addBtn = productControls.querySelector('.add-btn');
        const quantityControls = productControls.querySelector('.quantity-controls');
        const quantityDisplay = quantityControls.querySelector('.quantity-display');
        let existingItem = cartItems.find(item => item.name === productName);
        if (existingItem) {
            existingItem.quantity += 1;
            quantityDisplay.textContent = existingItem.quantity;
        } else {
            cartItems.push({
                name: productName,
                price: price,
                quantity: 1,
                note: ''
            });
            quantityDisplay.textContent = '1';
        }
        cartCount++;
        cartTotal += price;
        addBtn.style.display = 'none';
        quantityControls.classList.add('show');
        updateCartDisplay();
    }
    function increaseQuantityOnCard(productName, price, button) {
        const quantityDisplay = button.parentElement.querySelector('.quantity-display');
        let existingItem = cartItems.find(item => item.name === productName);
        if (existingItem) {
            existingItem.quantity++;
            quantityDisplay.textContent = existingItem.quantity;
            cartCount++;
            cartTotal += price;
            updateCartDisplay();
        }
    }
    function decreaseQuantityOnCard(productName, button) {
        const productControls = button.parentElement.parentElement;
        const addBtn = productControls.querySelector('.add-btn');
        const quantityControls = productControls.querySelector('.quantity-controls');
        const quantityDisplay = quantityControls.querySelector('.quantity-display');
        let existingItem = cartItems.find(item => item.name === productName);
        if (existingItem) {
            existingItem.quantity--;
            cartCount--;
            cartTotal -= existingItem.price;
            if (existingItem.quantity <= 0) {
                cartItems = cartItems.filter(item => item.name !== productName);
                addBtn.style.display = 'flex';
                quantityControls.classList.remove('show');
            } else {
                quantityDisplay.textContent = existingItem.quantity;
            }
            updateCartDisplay();
        }
    }
    function updateCartDisplay() {
        const cartBadge = document.getElementById('cartBadge');
        if (cartBadge) {
            cartBadge.textContent = cartCount;
        }
        
        if (cartCount > 0) {
            document.getElementById('cartSummary').classList.add('show');
            document.getElementById('cartItemsCount').textContent = cartCount + ' m√≥n';
            document.getElementById('cartTotalPrice').textContent = cartTotal.toLocaleString('vi-VN') ;
        } else {
            document.getElementById('cartSummary').classList.remove('show');
        }
    }

    function showCart() {
        if (cartItems.length === 0) {
            alert('Gi·ªè h√†ng tr·ªëng!');
            return;
        }
        document.getElementById('orderForm').classList.add('show'); // S·ª≠a: Hi·ªÉn th·ªã form th√¥ng tin
    if (!isOfflineMode) {
        document.getElementById('onlineOrderBtn').style.display = 'none'; // S·ª≠a: ·∫®n n√∫t "B·∫ÆT ƒê·∫¶U ƒê·∫∂T M√ìN"
		document.querySelector('.bottom-nav').style.display = 'none';
    }
        updateCartModal();
        document.getElementById('cartModal').classList.add('show');
        document.body.style.overflow = 'hidden';
        history.pushState({view: 'cart'}, 'Gi·ªè h√†ng');
    }

    function closeCart() {
        document.getElementById('cartModal').classList.remove('show');
        document.getElementById('orderForm').classList.remove('show');
        if (!isOfflineMode) {
            document.getElementById('onlineOrderBtn').style.display = 'block';
			document.querySelector('.bottom-nav').style.display = 'flex';
        }
        document.body.style.overflow = 'auto';
    }

    function backToMenu() {
        history.back();
    }
    
    function updateNoteForItem(index, note) {
        if (cartItems[index]) {
            cartItems[index].note = note;
        }
    }
	
	function handleNoteChange(index) {
    const selectElement = document.getElementById(`note-select-${index}`);
    const customInputElement = document.getElementById(`note-custom-${index}`);
    const selectedValue = selectElement.value;

    if (selectedValue === 'Kh√°c...') {
        customInputElement.style.display = 'block'; // Hi·ªán √¥ nh·∫≠p
        customInputElement.focus(); // T·ª± ƒë·ªông tr·ªè v√†o √¥ nh·∫≠p
        // C·∫≠p nh·∫≠t ghi ch√∫ l√† gi√° tr·ªã ƒëang c√≥ trong √¥ nh·∫≠p (th∆∞·ªùng l√† r·ªóng l√∫c ƒë·∫ßu)
        updateNoteForItem(index, customInputElement.value);
    } else {
        customInputElement.style.display = 'none'; // ·∫®n √¥ nh·∫≠p
        customInputElement.value = ''; // X√≥a gi√° tr·ªã trong √¥ nh·∫≠p
        // C·∫≠p nh·∫≠t ghi ch√∫ l√† gi√° tr·ªã ƒë√£ ch·ªçn
        updateNoteForItem(index, selectedValue);
    }
}

    function updateCartModal() {
    const modalBody = document.getElementById('cartModalBody');
    const modalTotalPrice = document.getElementById('modalTotalPrice');
    if (cartItems.length === 0) {
        modalBody.innerHTML = '<div class="empty-cart">Gi·ªè h√†ng tr·ªëng</div>';
        modalTotalPrice.textContent = '0 ';
        document.getElementById('orderButtons').style.display = 'none';
        return;
    }
    document.getElementById('orderButtons').style.display = 'flex';
    let modalHTML = '';
    cartItems.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        modalHTML += `
        <div class="cart-item-wrapper" style="border-bottom: 1px solid #f0f0f0;">
            <div class="cart-item" style="border-bottom: none; padding-bottom: 5px;">
                <div class="cart-item-left">
                    <div class="cart-item-image">
                        <img src="${PRODUCT_IMAGES[item.name] || 'https://i.postimg.cc/26g4X7hT/Hu-Tiu-Chay.jpg'}" 
                             alt="${item.name}"
                             style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;"
                             onerror="this.src='https://i.postimg.cc/26g4X7hT/Hu-Tiu-Chay.jpg';">
                    </div>
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">${item.price.toLocaleString('vi-VN')} </div>
                    </div>
                </div>
                <div class="cart-item-amount">${itemTotal.toLocaleString('vi-VN')} </div>
                <div class="cart-item-controls">
                    <button class="modal-quantity-btn" onclick="decreaseQuantityInModal(${index})">-</button>
                    <span class="modal-quantity-display">${item.quantity}</span>
                    <button class="modal-quantity-btn increase" onclick="increaseQuantityInModal(${index})">+</button>
                </div>
            </div>
            ${isOfflineMode ? `
            <div class="item-note-container" style="padding: 0px 10px 10px 68px; display: flex; flex-direction: column; align-items: flex-start; gap: 5px; margin-left: -8px;">
                
                <select id="note-select-${index}" class="item-note-input" onchange="handleNoteChange(${index})" style="width: 65%; border: 0.5px solid #e0e0e0; border-radius: 8px; padding: 5px 8px; font-size: 14px; box-sizing: border-box; background-color: #f8f9fa;">
                    <option value="">-- Ch·ªçn ghi ch√∫ --</option>
                    ${PREDEFINED_NOTES.map(note => `<option value="${note}" ${item.note === note ? 'selected' : ''}>${note}</option>`).join('')}
                </select>

                <input 
                    type="text" 
                    id="note-custom-${index}" 
                    class="item-note-input" 
                    placeholder="Nh·∫≠p ghi ch√∫ kh√°c..." 
                    value="${!PREDEFINED_NOTES.includes(item.note) ? (item.note || '') : ''}" 
                    oninput="updateNoteForItem(${index}, this.value)" 
                    style="width: 65%; border: 0.5px solid #e0e0e0; border-radius: 8px; padding: 5px 8px; font-size: 14px; box-sizing: border-box; display: ${!PREDEFINED_NOTES.includes(item.note) && item.note ? 'block' : 'none'};"
                >
            </div>
            ` : ''}
        </div>`; // D·∫•u ngo·∫∑c v√† d·∫•u ch·∫•m ph·∫©y n√†y ƒë√£ b·ªã thi·∫øu
    }); // V√≤ng l·∫∑p forEach k·∫øt th√∫c ·ªü ƒë√¢y

				
        modalBody.innerHTML = modalHTML;
        modalTotalPrice.textContent = cartTotal.toLocaleString('vi-VN') ;
    }
    function increaseQuantityInModal(index) {
        cartItems[index].quantity++;
        cartCount++;
        cartTotal += cartItems[index].price;
        updateCartDisplay();
        updateCartModal();
        updateProductCardQuantity(cartItems[index].name, cartItems[index].quantity);
    }
    function decreaseQuantityInModal(index) {
        const item = cartItems[index];
        item.quantity--;
        cartCount--;
        cartTotal -= item.price;
        if (item.quantity <= 0) {
            cartItems.splice(index, 1);
            resetProductCard(item.name);
            if (cartItems.length === 0) {
                history.back(); 
                return;
            }
        } else {
            updateProductCardQuantity(item.name, item.quantity);
        }
        updateCartDisplay();
        updateCartModal();
    }
    function updateProductCardQuantity(productName, quantity) {
        const productCards = document.querySelectorAll('.product-card');
        productCards.forEach(card => {
            const nameElement = card.querySelector('.product-name');
            if (nameElement && nameElement.textContent === productName) {
                const quantityDisplay = card.querySelector('.quantity-display');
                if (quantityDisplay) {
                    quantityDisplay.textContent = quantity;
                }
            }
        });
    }
    function resetProductCard(productName) {
        const productCards = document.querySelectorAll('.product-card');
        productCards.forEach(card => {
            const nameElement = card.querySelector('.product-name');
            if (nameElement && nameElement.textContent === productName) {
                const addBtn = card.querySelector('.add-btn');
                const quantityControls = card.querySelector('.quantity-controls');
                addBtn.style.display = 'flex';
                quantityControls.classList.remove('show');
            }
        });
    }
    function showOrderForm() {
        document.getElementById('orderForm').classList.add('show');
        document.getElementById('onlineOrderBtn').style.display = 'none';
    }

    async function submitOrder(event) {
        event.preventDefault();
        if (cartItems.length === 0) {
            alert('Gi·ªè h√†ng tr·ªëng!');
            return;
        }
        const isNameValid = validateName();
        const isPhoneValid = validatePhone();
        const isAddressValid = validateAddress();

        if (!isNameValid || !isPhoneValid || !isAddressValid) {
          alert('Vui l√≤ng ki·ªÉm tra l·∫°i th√¥ng tin ƒë√£ nh·∫≠p!');
          return;
        }
       const formData = new FormData(event.target);
       const customerName = formData.get('customerName');
       const customerPhone = formData.get('customerPhone');
       const ward = formData.get('ward');
       const streetAddress = formData.get('address'); 
       const note = formData.get('note');
        const fullAddress = `${streetAddress}, ${ward}, Tp.HCM`;

        const orderData = {
            action: 'submitOrder',
            customerName: customerName,
            customerPhone: customerPhone,
            address: fullAddress,
            note: note,
            items: cartItems,
            total: cartTotal,
            timestamp: new Date().toISOString()
        };
        
        showCustomAlert('ƒê·∫∂T H√ÄNG TH√ÄNH C√îNG !', orderData, 'online');

        fetch(SCRIPT_URLS.onlineOrder, {
            method: 'POST',
            mode: 'no-cors',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(orderData)
        }).catch(error => {
            console.error('L·ªói g·ª≠i ƒë∆°n h√†ng ng·∫ßm:', error);
        });
    }

    async function submitOfflineOrder() {
        if (cartItems.length === 0) {
            alert('Gi·ªè h√†ng tr·ªëng!');
            return;
        }

        const randomNumber = Math.floor(Math.random() * 90000000) + 10000000; 
        const orderId = 'OFF ' + randomNumber;

        const orderDataForSheet = cartItems.map(item => ({
            orderId: orderId,
            tableInfo: tableInfo,
            quantity: item.quantity,
            dishName: item.name,
            note: item.note || '',
			price: item.price,
            timestamp: new Date().toISOString()
        }));

        // Chu·∫©n b·ªã d·ªØ li·ªáu ƒë·ªÉ hi·ªÉn th·ªã tr√™n popup
        const orderDataForPopup = {
            action: 'submitOfflineOrder',
            // D√πng th√¥ng tin b√†n/mua v·ªÅ v√† m√£ ƒë∆°n cho g·ªçn
            customerName: `B√†n ${tableInfo === 'takeaway' ? 'Mua V·ªÅ' : tableInfo}`,
            customerPhone: orderId, 
            address: 'ƒê·∫∑t t·∫°i qu√°n',
            note: '',
            items: cartItems,
            total: cartTotal,
            timestamp: new Date().toISOString()
        };

        // Hi·ªÉn th·ªã popup ngay l·∫≠p t·ª©c v·ªõi ti√™u ƒë·ªÅ m·ªõi
    showCustomAlert('ƒê·∫∂T M√ìN TH√ÄNH C√îNG !', orderDataForPopup, 'offline');
        
        // === B·∫ÆT ƒê·∫¶U CH·ªàNH S·ª¨A QUAN TR·ªåNG ===
        // T√¨m n√∫t "ƒê√≥ng" v√† g√°n l·∫°i h√†nh ƒë·ªông cho n√≥ CH·ªà trong tr∆∞·ªùng h·ª£p offline n√†y
        const closeButton = document.querySelector('#customAlert .btn-secondary');
        if (closeButton) {
            closeButton.textContent = 'ƒê√≥ng'; // ƒê·ªïi ch·ªØ cho g·ªçn
            closeButton.onclick = function() {
                // G√°n tr·ª±c ti·∫øp 2 h√†nh ƒë·ªông: ·∫©n popup v√† ƒë√≥ng c·ª≠a s·ªï
                closeCustomAlert(); 
                window.close();     
            };
        }
        // === K·∫æT TH√öC CH·ªàNH S·ª¨A ===

        // G·ª≠i d·ªØ li·ªáu ƒëi √¢m th·∫ßm
        fetch(SCRIPT_URLS.offlineOrder, {
            method: 'POST',
            mode: 'no-cors',
            headers: {
                'Content-Type': 'text/plain;charset=utf-8'
            },
            body: JSON.stringify({
                action: 'submitOfflineOrder',
                data: orderDataForSheet
            })
        }).catch(error => {
            console.error('L·ªói g·ª≠i ƒë∆°n h√†ng offline √¢m th·∫ßm:', error);
        });
    }
    
    async function loadMenuFromSheets() {
        const productsGrid = document.getElementById('productsGrid');
        try {
            const response = await fetch(MENU_SCRIPT_URL + '?action=getMenu');
            if (!response.ok) throw new Error('Network response was not ok');
            const dynamicData = await response.json();
            // X√≥a menu tƒ©nh v√† render menu ƒë·ªông
            productsGrid.innerHTML = ''; 
            generateMenuHTML(dynamicData);
        } catch (error) {
            console.error('L·ªói load menu ƒë·ªông, menu tƒ©nh s·∫Ω ƒë∆∞·ª£c gi·ªØ l·∫°i.', error);
            // Kh√¥ng l√†m g√¨ c·∫£, ƒë·ªÉ menu tƒ©nh ƒë∆∞·ª£c hi·ªÉn th·ªã
        }
    }
    
    function generateMenuHTML(dataToRender) {
        const productsGrid = document.getElementById('productsGrid');
        if (!productsGrid || !dataToRender) return;

        const drinkNames = ['N∆∞·ªõc S√¢m', 'N∆∞·ªõc T√≠a T√¥', 'S∆∞∆°ng Sa H·∫°t √â', 'N∆∞·ªõc Nha ƒêam'];
        let html = '';
        dataToRender.forEach(item => {
            const isOutOfStock = item.status === 'H·∫øt h√†ng';
            const disabledClass = isOutOfStock ? ' disabled' : '';
            let categoryName = item.category;
            if (!categoryName || categoryName.trim() === '') {
                categoryName = drinkNames.includes(item.name) ? 'N∆∞·ªõc u·ªëng' : 'M√≥n ƒÉn';
            }
            const productImage = PRODUCT_IMAGES[item.name] || item.image || 'https://i.postimg.cc/26g4X7hT/Hu-Tiu-Chay.jpg';
            let imageContent = `<img src="${productImage}" alt="${item.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: inherit;" loading="lazy" width="400" height="400" onerror="this.src='https://i.postimg.cc/26g4X7hT/Hu-Tiu-Chay.jpg';">`;
            html += `
                <div class="product-card${disabledClass}" data-category="${categoryName}" data-status="${item.status}">
                    <div class="product-image">${imageContent}</div>
                    <div class="product-info">
                        <div class="product-name">${item.name}</div>
                        <div class="product-footer">
                            <div class="product-price">${parseInt(item.price).toLocaleString('vi-VN')}</div>
                            <div class="product-controls">
                                ${isOutOfStock ?
                                    '<button class="add-btn disabled" disabled>H·∫øt h√†ng</button>' :
                                    `<button class="add-btn" onclick="addToCart('${item.name}', ${item.price}, this)">+</button>`
                                }
                                <div class="quantity-controls">
                                    <button class="quantity-btn" onclick="decreaseQuantityOnCard('${item.name}', this)">-</button>
                                    <span class="quantity-display">1</span>
                                    <button class="quantity-btn increase" onclick="increaseQuantityOnCard('${item.name}', ${item.price}, this)">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });
        productsGrid.innerHTML = html;
        showCategory('all', document.querySelector('.category-tab.active'));
    }

    function resetCart() {
        document.querySelectorAll('.product-card').forEach(card => {
            const addBtn = card.querySelector('.add-btn');
            const quantityControls = card.querySelector('.quantity-controls');
            if (addBtn) addBtn.style.display = 'flex';
            if (quantityControls) quantityControls.classList.remove('show');
        });
        cartItems = [];
        cartCount = 0;
        cartTotal = 0;
        updateCartDisplay();
    }

    document.getElementById('cartModal').addEventListener('click', function(e) {
        if (e.target === this) {
            history.back(); 
        }
    });

    function smartFormatAddress(input) {
        if (!input.trim()) return "";
        let text = input.trim().replace(/\s+/g, " ").toLowerCase();
        return text.replace(/(^|\s)(.)/g, (match, space, char) => space + char.toUpperCase());
    }

    let currentOrderDetails = '';
    let adminMenuData = [];
    const ADMIN_CONFIG = {
        MENU_SCRIPT_URL: SCRIPT_URLS.menu,
        ADMIN_PASS: "0000",
        FETCH_TIMEOUT_MS: 30000
    };
	function slugify(text) {
    text = text.toString().toLowerCase().trim();
    const from = "√†√°·∫°·∫£√£√¢·∫ß·∫•·∫≠·∫©·∫´ƒÉ·∫±·∫Ø·∫∑·∫≥·∫µ√®√©·∫π·∫ª·∫Ω√™·ªÅ·∫ø·ªá·ªÉ·ªÖ√¨√≠·ªã·ªâƒ©√≤√≥·ªç·ªè√µ√¥·ªì·ªë·ªô·ªï·ªó∆°·ªù·ªõ·ª£·ªü·ª°√π√∫·ª•·ªß≈©∆∞·ª´·ª©·ª±·ª≠·ªØ·ª≥√Ω·ªµ·ª∑·ªπƒë";
    const to   = "aaaaaaaaaaaaaaaaaeeeeeeeeeeeiiiiiooooooooooooooooouuuuuuuuuuuyyyyyd";
    for (let i = 0, l = from.length; i < l; i++) {
        text = text.replace(new RegExp(from.charAt(i), 'g'), to.charAt(i));
    }
    text = text.replace(/[^a-z0-9 -]/g, '') 
               .replace(/\s+/g, '-') 
               .replace(/-+/g, '-'); 
    return text;
}
	
    let afterPasswordSuccessCallback = null;

    function showCustomAlert(title, orderData, mode = 'online') {
    // Lu√¥n ƒë·∫∑t ti√™u ƒë·ªÅ cho popup
    document.getElementById('alertTitle').textContent = title;

    // Lu√¥n hi·ªÉn th·ªã chi ti·∫øt m√≥n ƒÉn v√† t·ªïng ti·ªÅn
    const itemsContainer = document.getElementById('recap-items');
    itemsContainer.innerHTML = orderData.items.map((item, index) => {
        const itemTotal = item.price * item.quantity;
        let noteHTML = '';
        if (mode === 'offline' && item.note) {
            noteHTML = `<div class="item-recap-note">Ghi ch√∫: ${item.note}</div>`;
        }
        return `<div class="item"><span>${index + 1}. ${item.name} - x${item.quantity}</span><span>${itemTotal.toLocaleString('vi-VN')}</span></div>${noteHTML}`;
    }).join('');

    document.getElementById('recap-total').textContent = orderData.total.toLocaleString('vi-VN');

    const now = new Date();
    const formattedTime = `Th·ªùi gian ƒë·∫∑t h√†ng: ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')} ${String(now.getDate()).padStart(2, '0')}/${String(now.getMonth() + 1).padStart(2, '0')}/${now.getFullYear()}`;
    document.getElementById('order-time').textContent = formattedTime;

    // L·∫•y c√°c element c·∫ßn t√πy bi·∫øn
    const successMessage = document.querySelector('#customAlert .success-message');
    const successSubMessage = document.querySelector('#customAlert .success-submessage');
    const onlineInfoSection = document.querySelector('.order-summary-section:not(:has(#recap-items))');
    const zaloButton = document.querySelector('.custom-alert-btn.btn-primary');
    const closeButton = document.querySelector('.custom-alert-btn.btn-secondary');
    const footer = zaloButton ? zaloButton.parentElement : null;

    if (mode === 'offline') {
        // --- C·∫§U H√åNH CHO POPUP OFFLINE THEO Y√äU C·∫¶U ---

        // 2. S·ª≠a "C·∫£m ∆°n..." th√†nh "B·∫°n ƒë√£ g·ª≠i..."
        if (successMessage) successMessage.textContent = 'B·∫°n ƒë√£ g·ª≠i ƒë∆°n h√†ng ƒë·∫øn B·∫øp';

        // 4. X√≥a d√≤ng "Ch√∫ng t√¥i s·∫Ω li√™n h·ªá..."
        if (successSubMessage) successSubMessage.style.display = 'none';

        // 3. X√≥a (·∫©n) kh·ªëi th√¥ng tin kh√°ch h√†ng
        if (onlineInfoSection) onlineInfoSection.style.display = 'none';

        // 5. X√≥a (·∫©n) n√∫t Zalo
        if (zaloButton) zaloButton.style.display = 'none';

        // 6. ƒê∆∞a n√∫t ƒê√≥ng v√†o gi·ªØa
        if (footer) footer.style.justifyContent = 'center';

        // Thay ƒë·ªïi ch·ªØ n√∫t ƒê√≥ng cho g·ªçn
        if (closeButton) {
            closeButton.textContent = 'ƒê√≥ng';
            closeButton.style.flexGrow = ''; // B·ªè thu·ªôc t√≠nh c≈© n·∫øu c√≥
        }

    } else {
        // --- C·∫§U H√åNH CHO POPUP ONLINE (TR·∫¢ V·ªÄ M·∫∂C ƒê·ªäNH) ---
        // Tr·∫£ l·∫°i c√°c n·ªôi dung v√† hi·ªÉn th·ªã g·ªëc
        if (successMessage) successMessage.textContent = 'C·∫£m ∆°n Qu√Ω kh√°ch ƒë√£ ƒë·∫∑t h√†ng !';
        if (successSubMessage) successSubMessage.style.display = 'block';
        if (onlineInfoSection) onlineInfoSection.style.display = 'block';
        if (zaloButton) zaloButton.style.display = 'block';
        if (footer) footer.style.justifyContent = ''; // Tr·∫£ l·∫°i m·∫∑c ƒë·ªãnh
        
        // Hi·ªán th√¥ng tin kh√°ch h√†ng cho ƒë∆°n online
        document.getElementById('recap-customerName').textContent = orderData.customerName;
        document.getElementById('recap-customerPhone').textContent = orderData.customerPhone;
        document.getElementById('recap-address').textContent = orderData.address;
        
        const noteWrapper = document.getElementById('recap-note-wrapper');
        const noteEl = document.getElementById('recap-note');
        if (orderData.note) {
            noteEl.textContent = orderData.note;
            noteWrapper.style.display = 'block';
        } else {
            noteEl.textContent = '';
            noteWrapper.style.display = 'none';
        }

        if (closeButton) {
            closeButton.textContent = 'ƒê√≥ng v√† Ch·ªù x√°c nh·∫≠n';
            closeButton.style.flexGrow = '';
        }
    }

    document.getElementById('customAlert').classList.add('show');
    document.body.style.overflow = 'hidden';
    history.pushState({view: 'alert'}, 'Th√¥ng b√°o');
}

    function closeCustomAlert() {
        const popup = document.getElementById('customAlert');
        popup.classList.remove('show');
        document.body.style.overflow = 'auto';
        
            resetCart();
            currentOrderDetails = '';
        
    }

    function confirmZaloOrder() {
        const zaloUrl = `https://zalo.me/0763137082?text=${encodeURIComponent(currentOrderDetails)}`;
        window.open(zaloUrl, '_blank');
        history.back(); 
    }
    
    document.querySelector('.custom-alert-btn.btn-secondary').onclick = () => history.back();


    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
    });

    function addToHomeScreen() {
        if (deferredPrompt) {
            deferredPrompt.prompt();
        } else {
            alert("ƒê·ªÉ th√™m v√†o m√†n h√¨nh ch√≠nh, h√£y d√πng menu c·ªßa tr√¨nh duy·ªát (Chrome, Safari...) v√† ch·ªçn 'Th√™m v√†o m√†n h√¨nh ch√≠nh'.");
        }
    }
    
    function openZaloFromNav() {
        window.open('https://zalo.me/0763137082', '_blank');
    }

    function openAdminPopup() {
        document.getElementById('adminPopup').style.display = 'flex';
        showAdminGrid();
        history.pushState({adminView: 'grid'}, 'Admin Grid');
    }

    function closeAdminPopup() {
        document.getElementById('adminPopup').style.display = 'none';
    }

    function showAdminGrid() {
        document.getElementById('adminGrid').style.display = 'grid';
        document.getElementById('managementViews').style.display = 'none';
        const shopInfo = document.getElementById('adminShopInfoSection');
        if (shopInfo) {
            shopInfo.open = true;
        }
    }

    function showManagerView(viewId) {
        const action = () => {
            const shopInfo = document.getElementById('adminShopInfoSection');
            if (shopInfo) {
                shopInfo.open = false;
            }
            document.getElementById('adminGrid').style.display = 'none';
            document.getElementById('managementViews').style.display = 'block';
            document.querySelectorAll('.management-view').forEach(view => {
                view.style.display = 'none';
            });
            document.getElementById(viewId).style.display = 'block';
            history.pushState({adminView: 'manager'}, 'Admin Manager');
            if (viewId === 'orderManager') fetchPendingOrders();
            if (viewId === 'menuManager') fetchAdminMenu();
            if (viewId === 'storeHoursManager') loadStoreHours();
        };
        promptForAdminPassword(action);
    }
    
    function changePassword() {
        promptForAdminPassword(() => {
            showNewPasswordPrompt();
        });
    }

    function showAdminAlert(el, type, msg) {
        if (!el) return;
        el.className = `admin-alert ${type} show`;
        el.textContent = msg;
    }

    async function fetchAdminMenu() {
        const alertEl = document.getElementById('loadAlert');
        try {
            showAdminAlert(alertEl, 'info', 'ƒêang C·∫¨P NH·∫¨T MENU t·ª´ GoogleSheets');
            const res = await fetch(`${ADMIN_CONFIG.MENU_SCRIPT_URL}?action=getMenu`);
            if (!res.ok) throw new Error(`HTTP ${res.status} - ${res.statusText}`);
            
            const data = await res.json();
            if (data.error) throw new Error(data.error);
            if (!Array.isArray(data)) throw new Error('Ph·∫£n h·ªìi kh√¥ng ph·∫£i l√† m·∫£ng JSON.');
            
            adminMenuData = data.map(x => ({
                name: String(x.name ?? "(Kh√¥ng t√™n)"),
                price: Number(x.price ?? 0),
                status: String(x.status ?? "ƒêang b√°n")
            }));
            
            renderAdminMenuList();
            showAdminAlert(alertEl, 'success', `‚úÖ ƒê√£ C·∫¨P NH·∫¨T ${adminMenuData.length} m√≥n`);
            
        } catch (err) {
            showAdminAlert(alertEl, 'error', `‚ö† L·ªói t·∫£i menu: ${err.message}`);
        }
    }

    function renderAdminMenuList() {
        const container = document.getElementById('adminMenuList');
        const term = document.getElementById('menuSearch').value.trim().toLowerCase();
        container.innerHTML = '';
        const data = adminMenuData.filter(it => !term || it.name.toLowerCase().includes(term));
        if (!data.length) {
            container.innerHTML = '<div class="admin-alert info show">Kh√¥ng c√≥ m√≥n n√†o kh·ªõp.</div>';
            return;
        }
        data.forEach((item, i) => {
            const row = document.createElement('div');
            row.className = 'menu-item';
            row.innerHTML = `
                <div class="menu-name">
                    <div>${item.name}</div>
                    <div class="price">${(item.price||0).toLocaleString('vi-VN')}ƒë</div>
                </div>
                <label class="switch" title="${item.status}">
                    <input type="checkbox" ${item.status !== 'H·∫øt h√†ng' ? 'checked' : ''} onchange="toggleItemStatus(${i}, this)">
                    <span class="slider"></span>
                </label>
            `;
            container.appendChild(row);
        });
    }

    async function toggleItemStatus(index, checkbox) {
        const alertEl = document.getElementById('loadAlert');
        const item = adminMenuData[index];
        const prevStatus = item.status;
        const nextStatus = checkbox.checked ? 'ƒêang b√°n' : 'H·∫øt h√†ng';
        item.status = nextStatus;
        checkbox.disabled = true;
        try {
            showAdminAlert(alertEl, 'info', `üìû ƒêang c·∫≠p nh·∫≠t "${item.name}"...`);
            const res = await fetch(ADMIN_CONFIG.MENU_SCRIPT_URL, {
                method: 'POST',
                headers: {'Content-Type': 'text/plain'},
                body: JSON.stringify({ action: 'updateStatus', name: item.name, status: nextStatus })
            });
            if (!res.ok) throw new Error(`HTTP ${res.status}`);
            const responseText = await res.text();
            if (responseText.includes('Error')) throw new Error(responseText);
            showAdminAlert(alertEl, 'success', `‚úÖ "${item.name}" ‚Üí ${nextStatus}`);
            loadMenuFromSheets(); // T·∫£i l·∫°i menu sau khi thay ƒë·ªïi tr·∫°ng th√°i th√†nh c√¥ng
        } catch (err) {
            item.status = prevStatus;
            checkbox.checked = prevStatus !== 'H·∫øt h√†ng';
            showAdminAlert(alertEl, 'error', `‚ö† L·ªói c·∫≠p nh·∫≠t: ${err.message}`);
        } finally {
            checkbox.disabled = false;
        }
    }
     
    function toggleWardDropdown() {
        const dropdown = document.getElementById('wardDropdown');
        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }

    function selectWard(value) {
        document.getElementById('ward').value = value;
        toggleWardDropdown();
    }

    document.addEventListener('click', function(e) {
        if (!e.target.closest('.custom-select-wrapper')) {
            document.getElementById('wardDropdown').style.display = 'none';
        }
    });

    const STORE_HOURS_SCRIPT_URL = SCRIPT_URLS.storeHours;
    let normalHours = [];
    let breakPeriods = [];

    async function loadStoreHours() {
        const alertEl = document.getElementById('storeHoursAlert');
        try {
            showAdminAlert(alertEl, 'info', 'ƒêang t·∫£i gi·ªù ho·∫°t ƒë·ªông...');
            const response = await fetch(`${STORE_HOURS_SCRIPT_URL}?action=getStoreHours`);
            if (!response.ok) throw new Error(`HTTP ${response.status}`);
            const data = await response.json();
            if(data.error) throw new Error(data.error);
            normalHours = (data.normalHours?.length > 0) 
                ? data.normalHours 
                : [{ startHour: '06', startMinute: '00', endHour: '13', endMinute: '00' }, { startHour: '16', startMinute: '00', endHour: '20', endMinute: '00' }];
            breakPeriods = data.breakPeriods || [];
            renderNormalHours();
            renderBreakPeriods();
            updateAdminShopInfoHours(); 
            showAdminAlert(alertEl, 'success', 'T·∫£i gi·ªù ho·∫°t ƒë·ªông th√†nh c√¥ng!');
        } catch (error) {
            showAdminAlert(alertEl, 'error', `L·ªói t·∫£i d·ªØ li·ªáu: ${error.message}`);
        }
    }

    function renderNormalHours() {
        const container = document.getElementById('normalHoursList');
        container.innerHTML = normalHours.map((hour, index) => `
            <div class="hour-range-item">
                <div class="time-inputs">
                    <select class="time-input" onchange="updateNormalHour(${index}, 'startHour', this.value)">${generateHourOptions(hour.startHour)}</select>
                    <span>:</span>
                    <select class="time-input" onchange="updateNormalHour(${index}, 'startMinute', this.value)">${generateMinuteOptions(hour.startMinute)}</select>
                    <span class="time-separator">‚Üí</span>
                    <select class="time-input" onchange="updateNormalHour(${index}, 'endHour', this.value)">${generateHourOptions(hour.endHour)}</select>
                    <span>:</span>
                    <select class="time-input" onchange="updateNormalHour(${index}, 'endMinute', this.value)">${generateMinuteOptions(hour.endMinute)}</select>
                </div>
            </div>`).join('');
    }

    function generateHourOptions(selected) {
        let opts = '';
        for (let i = 0; i <= 23; i++) {
            const h = i.toString().padStart(2, '0');
            opts += `<option value="${h}" ${h === selected ? 'selected' : ''}>${h}</option>`;
        }
        return opts;
    }
    function generateMinuteOptions(selected) {
        return ['00', '15', '30', '45'].map(m => `<option value="${m}" ${m === selected ? 'selected' : ''}>${m}</option>`).join('');
    }
    function updateNormalHour(index, field, value) {
        normalHours[index][field] = value;
    }

    function renderBreakPeriods() {
        const container = document.getElementById('currentBreaks');
        if (!breakPeriods || breakPeriods.length === 0) {
            container.innerHTML = '<div style="text-align: center; color: #666; padding: 10px 0; font-size: 13px;">Ch∆∞a c√≥ l·ªãch ngh·ªâ n√†o.</div>';
            return;
        }
        container.innerHTML = breakPeriods.map((bp, index) => {
            const formattedStart = new Date(bp.startDate + 'T00:00:00').toLocaleDateString('vi-VN');
            const formattedEnd = new Date(bp.endDate + 'T00:00:00').toLocaleDateString('vi-VN');
            return `
            <div class="break-period-item">
                <div class="break-info">
                    <div class="break-dates">${formattedStart} - ${formattedEnd}</div>
                    ${bp.reason ? `<div class="break-reason">${bp.reason}</div>` : ''}
                </div>
                <button class="delete-break-btn" onclick="deleteBreakPeriod(${index})">X√≥a</button>
            </div>`;
        }).join('');
    }

    function addBreakPeriod() {
        const startDate = document.getElementById('breakStartDate').value;
        const endDate = document.getElementById('breakEndDate').value;
        const reason = document.getElementById('breakReason').value.trim();
        const alertEl = document.getElementById('storeHoursAlert');
        if (!startDate || !endDate) return showAdminAlert(alertEl, 'error', 'Vui l√≤ng ch·ªçn ng√†y b·∫Øt ƒë·∫ßu v√† k·∫øt th√∫c.');
        if (new Date(startDate) > new Date(endDate)) return showAdminAlert(alertEl, 'error', 'Ng√†y b·∫Øt ƒë·∫ßu kh√¥ng th·ªÉ sau ng√†y k·∫øt th√∫c.');
        breakPeriods.push({ startDate, endDate, reason: reason || 'T·∫°m ngh·ªâ' });
        document.getElementById('breakStartDate').value = '';
        document.getElementById('breakEndDate').value = '';
        document.getElementById('breakReason').value = '';
        renderBreakPeriods();
        showAdminAlert(alertEl, 'success', 'ƒê√£ th√™m th·ªùi gian ngh·ªâ.');
    }
    function deleteBreakPeriod(index) {
        breakPeriods.splice(index, 1);
        renderBreakPeriods();
    }

    async function saveStoreHours() {
        const alertEl = document.getElementById('storeHoursAlert');
        try {
            showAdminAlert(alertEl, 'info', 'ƒêang l∆∞u gi·ªù ho·∫°t ƒë·ªông...');
            const response = await fetch(STORE_HOURS_SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'saveStoreHours', normalHours, breakPeriods }),
            });
            if (!response.ok) throw new Error(`L·ªói m·∫°ng: ${response.statusText}`);
            const result = await response.json();
            if (result.status !== 'success') throw new Error(result.message || 'L·ªói kh√¥ng x√°c ƒë·ªãnh.');
            showAdminAlert(alertEl, 'success', 'L∆∞u gi·ªù ho·∫°t ƒë·ªông th√†nh c√¥ng!');
            updateAdminShopInfoHours();
            loadStoreHoursForCheck();
        } catch (error) {
            showAdminAlert(alertEl, 'error', `L·ªói l∆∞u d·ªØ li·ªáu: ${error.message}.`);
        }
    }
     
    function updateProductButtonsState() {
        document.getElementById('productsGrid').classList.toggle('store-closed', !isStoreOpen);
    }

    function checkStoreStatus() {
        if (isOfflineMode) { return; } 
        
        const now = new Date();
        const currentDate = now.toISOString().split('T')[0];
        const currentTimeInMinutes = now.getHours() * 60 + now.getMinutes();
        const isBreakDay = breakPeriods.some(bp => currentDate >= bp.startDate && currentDate <= bp.endDate);
        if (isBreakDay) {
            const currentBreak = breakPeriods.find(bp => currentDate >= bp.startDate && currentDate <= bp.endDate);
            isStoreOpen = false;
            showStoreClosedPopup('Qu√°n ƒëang T·∫†M NGH·ªà', `${currentBreak.reason || 'S·∫Ω s·ªõm ho·∫°t ƒë·ªông tr·ªü l·∫°i.'}`);
            updateProductButtonsState();
            return;
        }
        let storeIsOpenNow = false;
        for (const hour of normalHours) {
            const startTime = parseInt(hour.startHour) * 60 + parseInt(hour.startMinute);
            const endTime = parseInt(hour.endHour) * 60 + parseInt(hour.endMinute);
            if (startTime <= endTime) {
                if (currentTimeInMinutes >= startTime && currentTimeInMinutes < endTime) {
                    storeIsOpenNow = true;
                    break;
                }
            } 
            else {
                if (currentTimeInMinutes >= startTime || currentTimeInMinutes < endTime) {
                    storeIsOpenNow = true;
                    break;
                }
            }
        }
        isStoreOpen = storeIsOpenNow;
        if (!isStoreOpen) {
            const allOpeningSlots = normalHours
                .map(h => ({ 
                    time: parseInt(h.startHour) * 60 + parseInt(h.startMinute), 
                    str: `${h.startHour}:${h.startMinute}` 
                }))
                .sort((a, b) => a.time - b.time);
            const nextSlotToday = allOpeningSlots.find(slot => slot.time > currentTimeInMinutes);
            let message;
            if (nextSlotToday) {
                message = `Qu√°n s·∫Ω m·ªü c·ª≠a l·∫°i v√†o ${nextSlotToday.str} h√¥m nay.`;
            } else {
                message = `Qu√°n s·∫Ω m·ªü c·ª≠a l·∫°i v√†o ${allOpeningSlots[0].str} ng√†y mai.`;
            }
            showStoreClosedPopup('QU√ÅN T·∫†M ƒê√ìNG C·ª¨A', message);
        }
        updateProductButtonsState();
    }

    function showStoreClosedPopup(title, message) {
        document.getElementById('storeStatusTitle').textContent = title;
        document.getElementById('storeStatusMessage').innerHTML = message;
        document.getElementById('storeStatusPopup').classList.add('show');
        document.body.style.overflow = 'hidden';
    }
    function closeStoreStatusPopup() {
        document.getElementById('storeStatusPopup').classList.remove('show');
        document.body.style.overflow = 'auto';
    }

    async function loadStoreHoursForCheck() {
        if (isOfflineMode) {
            isStoreOpen = true;
            updateProductButtonsState();
            return;
        }
        try {
            const response = await fetch(`${STORE_HOURS_SCRIPT_URL}?action=getStoreHours`);
            if (response.ok) {
                const data = await response.json();
                normalHours = data.normalHours?.length > 0 ? data.normalHours : [{startHour: '06',startMinute: '00',endHour: '13',endMinute: '00'}, {startHour: '16',startMinute: '00',endHour: '20',endMinute: '00'}];
                breakPeriods = data.breakPeriods || [];
            }
        } catch (error) {
            console.warn('Kh√¥ng th·ªÉ t·∫£i gi·ªù t·ª´ xa, d√πng gi·ªù m·∫∑c ƒë·ªãnh.', error);
            normalHours = [{startHour: '06',startMinute: '00',endHour: '13',endMinute: '00'}, {startHour: '16',startMinute: '00',endHour: '20',endMinute: '00'}];
        } finally {
            updateAdminShopInfoHours(); 
            checkStoreStatus();
        }
    }
            
    function updateAdminShopInfoHours() {
        const container = document.getElementById('adminShopOpeningHours');
        if (!container || !normalHours || normalHours.length === 0) return;
        const sortedHours = [...normalHours].sort((a, b) => (parseInt(a.startHour) * 60 + parseInt(a.startMinute)) - (parseInt(b.startHour) * 60 + parseInt(b.startMinute)));
        const formattedStrings = sortedHours.map(range => `<span style="color: #02a046; font-weight: 600;">${range.startHour}:${range.startMinute} - ${range.endHour}:${range.endMinute}</span>`);
        container.innerHTML = `<strong>Gi·ªù m·ªü c·ª≠a:</strong><div style="margin-left: 8px; line-height: 1.6;">${formattedStrings.join('<br>')}</div>`;
    }

    let allFetchedOrders = [];
    const INITIAL_ORDER_DISPLAY_COUNT = 10;

    async function fetchPendingOrders() {
        const alertEl = document.getElementById('orderAlert');
        const listContainer = document.getElementById('adminOrderList');
        showAdminAlert(alertEl, 'info', 'ƒêang t·∫£i c√°c ƒë∆°n h√†ng c·∫ßn x·ª≠ l√Ω...');
        listContainer.innerHTML = '<div class="loading-spinner" style="margin: 20px auto;"></div>';
        try {
            const response = await fetch(`${SCRIPT_URLS.onlineOrder}?action=getOrders`);
            if (!response.ok) throw new Error(`L·ªói m·∫°ng: ${response.status}`);
            const allOrdersFromServer = await response.json();
            if (allOrdersFromServer.error) throw new Error(allOrdersFromServer.message);
            const orders = allOrdersFromServer.filter(order => 
                order.status !== 'Ho√†n th√†nh' && order.status !== 'ƒê√£ h·ªßy'
            );
            orders.sort((a, b) => {
                const isAWaiting = a.status === 'Ch·ªù x√°c nh·∫≠n';
                const isBWaiting = b.status === 'Ch·ªù x√°c nh·∫≠n';
                if (isAWaiting && !isBWaiting) return -1;
                if (!isAWaiting && isBWaiting) return 1;
                return new Date(b.timestamp) - new Date(a.timestamp);
            });
            allFetchedOrders = orders;
            showAdminAlert(alertEl, 'success', `C√≥ ${allFetchedOrders.length} ƒë∆°n h√†ng c·∫ßn x·ª≠ l√Ω.`);
            renderOrderList(true);
        } catch (error) {
            showAdminAlert(alertEl, 'error', `L·ªói t·∫£i ƒë∆°n h√†ng: ${error.message}`);
            listContainer.innerHTML = '';
        }
    }

    function renderOrderList(showOnlyPending = true) {
        const container = document.getElementById('adminOrderList');
        container.innerHTML = '';
        const deliveringOrders = allFetchedOrders.filter(order => order.status === 'ƒêang giao');
        const ordersToDisplay = showOnlyPending
            ? allFetchedOrders.filter(order => order.status === 'Ch·ªù x√°c nh·∫≠n')
            : allFetchedOrders.filter(order => order.status === 'Ch·ªù x√°c nh·∫≠n' || order.status === 'ƒêang giao');
        const pendingCount = allFetchedOrders.filter(order => order.status === 'Ch·ªù x√°c nh·∫≠n').length;
        if (ordersToDisplay.length === 0 && pendingCount === 0) {
            container.innerHTML = '<div class="admin-alert info show">Kh√¥ng c√≥ ƒë∆°n h√†ng n√†o ƒëang ch·ªù x√°c nh·∫≠n.</div>';
        }
        ordersToDisplay.sort((a, b) => {
            if (a.status === 'Ch·ªù x√°c nh·∫≠n' && b.status !== 'Ch·ªù x√°c nh·∫≠n') return -1;
            if (a.status !== 'Ch·ªù x√°c nh·∫≠n' && b.status === 'Ch·ªù x√°c nh·∫≠n') return 1;
            return 0;
        });
        ordersToDisplay.forEach(order => {
            const statusString = String(order.status || '').toLowerCase();
            
const statusClass = `status-${slugify(order.status || '')}`;
            const orderDate = new Date(order.timestamp);
            const formattedTime = orderDate.toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' });
            const formattedDate = orderDate.toLocaleDateString('vi-VN');
            const card = document.createElement('div');
            card.className = `order-card ${statusClass}`;
            const cleanPhone = (order.customerPhone || '').replace(/'/g, "");
            card.innerHTML = `
                <div class="order-header">
                    <div class="order-customer-info">
                        <div class="customer-name-phone">
                            ${order.customerName} 
                            <a href="tel:${cleanPhone}" style="font-weight: bold; color: #000; text-decoration: none;"> - ${cleanPhone}</a>
                        </div>
                        <div class="order-timestamp-customer"><small>${formattedTime} - ${formattedDate}</small></div>
                    </div>
                    <div class="order-total">${parseInt(order.total).toLocaleString('vi-VN')}</div>
                </div>
                <div class="order-details">
                    <p><strong>ƒê·ªãa ch·ªâ:</strong> ${order.address || ''}</p>
                    ${order.note ? `<p><strong>Ghi ch√∫:</strong> ${order.note}</p>` : ''}
                    <div class="order-items">
    <strong>M√≥n ƒë√£ ƒë·∫∑t:</strong>
    <div class="item-list">${(order.items || '').replace(/\n/g, '<br>')}</div>
</div>
                </div>
                <div class="order-actions">
                    <label for="status-${order.rowNumber}"><strong>Tr·∫°ng th√°i:</strong></label>
                    <select id="status-${order.rowNumber}" class="order-status-select" onchange="updateOrderStatus(${order.rowNumber}, this)">
                        <option value="Ch·ªù x√°c nh·∫≠n" ${order.status === 'Ch·ªù x√°c nh·∫≠n' ? 'selected' : ''}>‚è≥ Ch·ªù x√°c nh·∫≠n</option>
                        <option value="ƒêang giao" ${order.status === 'ƒêang giao' ? 'selected' : ''}>üöö ƒêang giao</option>
                        <option value="Ho√†n th√†nh" ${order.status === 'Ho√†n th√†nh' ? 'selected' : ''}>‚úÖ Ho√†n th√†nh</option>
                        <option value="ƒê√£ h·ªßy" ${order.status === 'ƒê√£ h·ªßy' ? 'selected' : ''}>‚ùå ƒê√£ h·ªßy</option>
                    </select>
                </div>`;
            container.appendChild(card);
        });
        if (showOnlyPending && deliveringOrders.length > 0) {
            const loadMoreButton = document.createElement('button');
            loadMoreButton.textContent = `Xem ${deliveringOrders.length} ƒë∆°n h√†ng ƒëang giao`;
            loadMoreButton.className = 'submit-btn';
            loadMoreButton.style.cssText = 'display: block; width: fit-content; margin: 15px auto 0 auto; background-color: #fff4cd; color:#02a046; padding: 8px 15px;';
            loadMoreButton.onclick = () => renderOrderList(false);
            container.appendChild(loadMoreButton);
        }
    }

    async function updateOrderStatus(rowNumber, selectElement) {
        const newStatus = selectElement.value;
        const alertEl = document.getElementById('orderAlert');
        selectElement.disabled = true;
        const originalBorder = selectElement.style.border;
        selectElement.style.border = '2px solid #ffc107';
        showAdminAlert(alertEl, 'info', `ƒêang c·∫≠p nh·∫≠t ƒë∆°n h√†ng...`);

        try {
            const response = await fetch(SCRIPT_URLS.onlineOrder, {
                method: 'POST',
                headers: {'Content-Type': 'text/plain'},
                body: JSON.stringify({ action: 'updateStatus', rowNumber, status: newStatus })
            });
            const result = await response.json();
            if (result.status !== 'success') throw new Error(result.message || 'L·ªói t·ª´ server.');
            showAdminAlert(alertEl, 'success', `C·∫≠p nh·∫≠t th√†nh c√¥ng! Tr·∫°ng th√°i: ${newStatus}.`);
            selectElement.style.border = '2px solid #198754';
            const orderCard = selectElement.closest('.order-card');
            if (orderCard) {
                orderCard.className = 'order-card';
                orderCard.classList.add(`status-${newStatus.toLowerCase().replace(/[^a-z0-9]/g, '-')}`);
            }
        } catch (error) {
            showAdminAlert(alertEl, 'error', `L·ªói c·∫≠p nh·∫≠t: ${error.message}`);
            selectElement.style.border = '2px solid #dc3545';
            const order = allFetchedOrders.find(o => o.rowNumber === rowNumber);
            if (order) selectElement.value = order.status;
        } finally {
            setTimeout(() => {
                selectElement.disabled = false;
                selectElement.style.border = originalBorder;
            }, 1000);
        }
    }

    function promptForAdminPassword(onSuccess) {
        const promptEl = document.getElementById('passwordPrompt');
        const inputs = document.querySelectorAll('#passwordInputs .password-digit');
        afterPasswordSuccessCallback = onSuccess;
        inputs.forEach(input => input.value = '');
        promptEl.style.display = 'flex';
        inputs[0].focus();
    }

    function closePasswordPrompt() {
        document.getElementById('passwordPrompt').style.display = 'none';
        afterPasswordSuccessCallback = null;
    }

    function setupPasswordInputListeners() {
        const inputs = Array.from(document.querySelectorAll('#passwordInputs .password-digit'));
        inputs.forEach((input, index) => {
            input.addEventListener('input', () => {
                if (input.value && index < inputs.length - 1) inputs[index + 1].focus();
                if (inputs.every(i => i.value)) verifyPassword();
            });
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && !input.value && index > 0) inputs[index - 1].focus();
            });
        });
    }

    function verifyPassword() {
        const promptEl = document.getElementById('passwordPrompt');
        const inputs = document.querySelectorAll('#passwordInputs .password-digit');
        const enteredPassword = Array.from(inputs).map(i => i.value).join('');

        if (enteredPassword === ADMIN_CONFIG.ADMIN_PASS) {
            if (typeof afterPasswordSuccessCallback === 'function') {
                afterPasswordSuccessCallback();
            }
            closePasswordPrompt();
        } else {
            promptEl.classList.add('shake');
            inputs.forEach(input => {
                input.value = '';
                input.style.borderColor = '#dc3545';
            });
            setTimeout(() => {
                promptEl.classList.remove('shake');
                inputs.forEach(input => input.style.borderColor = '#ccc');
                inputs[0].focus();
            }, 500);
        }
    }

    function showNewPasswordPrompt() {
        const promptEl = document.getElementById('newPasswordPrompt');
        const inputs = promptEl.querySelectorAll('.password-digit');
        inputs.forEach(input => input.value = '');
        promptEl.style.display = 'flex';
        if (inputs.length > 0) {
            inputs[0].focus();
        }
    }

    function closeNewPasswordPrompt() {
        document.getElementById('newPasswordPrompt').style.display = 'none';
    }

    function saveNewPassword() {
        const inputs = document.querySelectorAll('#newPasswordInputs .password-digit');
        const newPassword = Array.from(inputs).map(i => i.value).join('');

        if (newPassword.length === 4) {
            ADMIN_CONFIG.ADMIN_PASS = newPassword;
            alert('ƒê√£ ƒë·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng!');
            closeNewPasswordPrompt();
        } else {
            const promptEl = document.getElementById('newPasswordPrompt');
            promptEl.classList.add('shake');
            inputs.forEach(input => {
                input.value = '';
                input.style.borderColor = '#dc3545';
            });
            setTimeout(() => {
                promptEl.classList.remove('shake');
                inputs.forEach(input => input.style.borderColor = '#ccc');
                if (inputs.length > 0) inputs[0].focus();
            }, 500);
        }
    }

    function setupNewPasswordInputListeners() {
        const inputs = Array.from(document.querySelectorAll('#newPasswordInputs .password-digit'));
        inputs.forEach((input, index) => {
            input.addEventListener('input', () => {
                if (input.value && index < inputs.length - 1) {
                    inputs[index + 1].focus();
                }
                if (inputs.every(i => i.value)) {
                    saveNewPassword();
                }
            });
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && !input.value && index > 0) {
                    inputs[index - 1].focus();
                }
            });
        });
    }

    window.addEventListener('popstate', (event) => {
        const isManagerViewVisible = document.getElementById('managementViews').style.display === 'block';
        const isAdminPopupVisible = document.getElementById('adminPopup').style.display === 'flex';
        const isCartVisible = document.getElementById('cartModal').classList.contains('show');
        const isAlertVisible = document.getElementById('customAlert').classList.contains('show');

        if (isManagerViewVisible) {
            showAdminGrid();
        } else if (isAdminPopupVisible) {
            closeAdminPopup();
        } else if (isCartVisible) {
            closeCart();
        } else if (isAlertVisible) {
            closeCustomAlert();
        } else {
            history.pushState({view: 'home'}, 'Trang ch·ªß', window.location.pathname);
        }
    });

</script>

<style id="non-critical-css">
    /* CSS KH√îNG QUAN TR·ªåNG - T·∫£i sau khi trang ƒë√£ hi·ªÉn th·ªã */
	
.order-items .item-list {
    text-align: right;
}	


#storeHoursManager .hours-section h4 {
    font-size: 13px; 
}
    #storeHoursAlert.admin-alert.success {
    font-size: 13px; 
}
    .featured-banner::before {
        content: '';
        position: absolute;
        top: 100%;
        right: 100%;
        width: 200px;
        height: 500px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10%;
    }
    .close-btn, .menu-btn {
        background: none;
        border: none;
        font-size: 22px;
        color: #666;
        cursor: pointer;
        padding: 5px;
    }
    .product-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
    }
    .product-card.disabled {
        opacity: 0.6;
    }
    .product-image {
        position: relative;
        aspect-ratio: 1;
        
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 30px;
        text-align: center;
        padding: 0.5px;
        margin: 0.5px;
        border-radius: 15px;
    }
    .product-image::before {
        content: '';
        position: absolute;
        top: 6px;
        left: 6px;
        background: rgba(255, 255, 255, 0.2);
        padding: 5px;
        border-radius: 15px;
        font-size: 15px;
        font-weight: 600;
    }
    .special-label::before {
        content: 'H·∫øt h√†ng';
        background: rgba(220, 53, 69, 0.9);
        color: white;
        font-size: 12px !important;
    }
    .product-info {
        padding: 8px;
    }
    .product-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 8px;
    }
    .product-controls {
        display: flex;
        align-items: center;
    }
    .add-btn {
        background: #02a046;
        color: white;
        border: none;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        font-size: 18px;
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .add-btn:hover {
        background: #018a3d;
        transform: scale(1.1);
    }
    .add-btn.disabled {
        background: #dc3545;
        cursor: not-allowed;
        font-size: 14px;
        width: auto;
        padding: 4px 6px;
    }
    .add-btn.disabled:hover {
        background: #dc3545;
        transform: none;
    }
    .quantity-controls {
        display: none;
        align-items: center;
        gap: 6px;
    }
    .quantity-controls.show {
        display: flex;
    }
    .quantity-btn {
        background: #f0f0f0;
        color: #333;
        border: none;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        font-size: 24px;
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .quantity-btn:hover {
        background: #e0e0e0;
        transform: scale(1.1);
    }
    .quantity-btn.increase {
        background: #02a046;
        color: white;
    }
    .quantity-btn.increase:hover {
        background: #018a3d;
    }
    .quantity-display {
        font-weight: 600;
        min-width: 18px;
        text-align: center;
        font-size: 18px;
        color: #333;
    }
    .cart-summary {
        position: fixed;
        bottom: 48px;
        left: 10px;
        right: 10px;
        background: #02a046;
        color: white;
        border-radius: 25px;
        padding: 7px;
        display: none;
        align-items: center;
        justify-content: space-between;
        z-index: 99;
        box-shadow: 0 4px 15px rgba(2, 160, 70, 0.3);
    }
    .cart-summary.show {
        display: flex;
    }
    .cart-summary-left {
        flex: 1;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .cart-items-count, .cart-total-price {
        font-size: 18px;
        font-weight: 600;
        margin: 0;
    }
    .cart-total-price {
        font-size: 17px;
        font-weight: bold;
    }
    .view-cart-btn {
        background: #f0f8f4;
        color: #02a046;
        border: none;
        padding: 8px;
        border-radius: 20px;
        font-size: 17px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
    }
    .view-cart-btn:hover {
        background: rgba(255, 255, 255, 0.3);
    }
    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        border-top: 1px solid #e0e0e0;
        display: flex;
        z-index: 100;
        height: 50px;
    }
    .nav-item {
        flex: 1;
        padding: 4px;
        text-align: center;
        border: none;
        background: none;
        cursor: pointer;
        transition: background 0.3s;
        text-decoration: none;
        color: #666;
    }
    .nav-item.active {
        color: #02a046;
        background: #f0f8f4;
    }
    .nav-item:hover {
        background: #f8f8f8;
    }
    .nav-icon {
        font-size: 15px;
        margin-bottom: 4px;
    }
    .nav-text {
        font-size: 15px;
        font-weight: 500;
    }
    .cart-badge {
        position: absolute;
        top: 1px;
        right: 5px;
        background: #02a046;
        color: white;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        font-size: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
    }
    .cart-modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: -1.5px;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 2px;
    }
    .cart-modal.show {
        display: flex;
    }
    .cart-modal-content {
        background: white;
        border-radius: 12px;
        width: 100%;
        height: 100%;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    .cart-modal-header {
        padding: 10px;
        border-bottom: 1px solid #e0e0e0;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #02a046;
    }
    .cart-modal-title {
        font-size: 20px;
        font-weight: 600;
    }
    .cart-modal-body {
        padding: 6px;
        flex: 1;
        overflow-y: auto;
        max-height: calc(100vh - 200px);
    }
    .cart-item {
        display: grid;
        grid-template-columns: auto 1fr auto auto;
        align-items: center;
        padding: 7px 0;
        border-bottom: 1px solid #f0f0f0;
        gap: 10px;
    }
    .cart-item:last-child {
        border-bottom: none;
    }
    .cart-item-left {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    .cart-item-image {
        width: 50px;
        height: 50px;
        background: #fff;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 38px;
        font-weight: bold;
        flex-shrink: 0;
        overflow: hidden;
        border: 0.2px solid #02a046;
    }
    .cart-item-info {
        flex: 1;
        min-width: 0;
    }
    .cart-item-name {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 4px;
    }
    .cart-item-price {
        font-size: 16px;
        color: #666;
    }
    .cart-item-amount {
        font-size: 16px;
        font-weight: 600;
        color: #666;
        min-width: 80px;
        text-align: right;
        padding-right: 20px;
    }
    .cart-item-controls {
        display: flex;
        align-items: center;
        gap: 10px;
        flex-shrink: 0;
    }
    .modal-quantity-btn {
        font-size: 22px;
        background: #f0f0f0;
        border: none;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #333;
    }
    .modal-quantity-btn:hover {
        background: #e0e0e0;
    }
    .modal-quantity-btn.increase {
        background: #02a046;
        color: white;
    }
    .modal-quantity-btn.increase:hover {
        background: #018a3d;
    }
    .modal-quantity-display {
        font-weight: 600;
        min-width: 20px;
        text-align: center;
    }
    .cart-modal-footer {
        padding: 10px 10px 0px 10px;
        border-top: 1px solid #e0e0e0;
        margin-top: auto;
    }
    .cart-total {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 16px;
        font-weight: bold;
        padding: 6px 12px;
        background: #f8f9fa;
        color: #02a046;
        border: 0.5px solid #02a046;
        border-radius: 20px;
        margin-bottom: 0;
        margin-left: auto;
    }
    .back-to-menu-btn {
        background: #fff4cd;
        color:  #02a046;
        border: none;
        padding: 7px 12px;
        border-radius: 20px;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
    }
    .back-to-menu-btn:hover {
        background: #f1c40f;
    }
    .order-buttons {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 10px;
        margin-bottom: 5px;
    }
    .order-btn {
        background: #02a046;
        color: white;
        border: none;
        padding: 10px 12px;
        border-radius: 20px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        white-space: nowrap;
        flex-basis: 100%;
    }
    .order-btn:hover {
        background: #018a3d;
    }
    .order-form {
        display: none;
        margin-top: 10px;
    }
    .order-form.show {
        display: block;
    }
    .address-input-group {
        position: relative;
    }
    .map-icon {
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: #02a046;
        font-size: 20px;
        cursor: pointer;
    }
    .map-icon:hover {
        color: #018a3d;
    }
    .submit-btn:disabled {
        background: #6c757d;
        cursor: not-allowed;
    }
    .empty-cart {
        text-align: center;
        color: #666;
        padding: 40px 20px;
    }
    .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 9999;
    }
    .loading-overlay.show {
        display: flex;
    }
    .loading-content {
        background: white;
        padding: 30px;
        border-radius: 12px;
        text-align: center;
        max-width: 300px;
    }
    .loading-spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #02a046;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 15px;
    }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    /* --- Start: New Success Popup Styles --- */
    .custom-alert {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        z-index: 9999;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 15px;
    }
    .custom-alert.show {
        display: flex;
    }
    .custom-alert-content {
        background: white;
        border-radius: 15px;
        width: 100%;
        max-width: 420px;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    }
    .custom-alert-header {
        background: #02a046;
        color: white;
        padding: 10px;
        text-align: center;
        font-size: 22px;
        font-weight: bold;
    }
    .custom-alert-body {
        padding: 10px 20px 5px 20px;
        flex: 1;
        overflow-y: auto;
        font-size: 15px;
        line-height: 1.5;
    }
    .custom-alert-footer {
        padding: 12px;
        border-top: 1px solid #e0e0e0;
        display: flex;
        gap: 10px;
    }
    .custom-alert-btn {
        flex: 1;
        padding: 10px;
        border: none;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
    }
    .btn-primary {
        background: #02a046;
        color: white;
    }
    .btn-secondary {
        background: #fff3cd;
        color: #333;
    }
    .custom-alert.order-success-popup .custom-alert-content {
        height: auto;
        max-height: 90vh;
    }
    .order-success-popup .success-icon {
        width: 45px;
        height: 45px;
        background: #e8f5e9;
        color: #02a046;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 4px auto 4px;
        padding: 8px;
        box-sizing: border-box;
    }
    .order-success-popup .success-message {
        text-align: center;
        font-weight: 600;
        font-size: 18px;
        color: #333;
        margin-bottom: 3px;
    }
    .order-success-popup .success-submessage {
        text-align: center;
        color: #666;
        font-size: 14px;
        margin-bottom: 5px;
    }
    .order-success-popup .order-timestamp {
        text-align: center;
        color: #555;
        font-size: 14px;
        font-style: italic;
        margin-bottom: 15px;
    }
    .order-success-popup .order-summary-section {
        background: #f8f9fa;
        border: 1px solid #f0f0f0;
        border-radius: 12px;
        padding: 8px 10px; 
        margin-bottom: 8px;
    }
    .order-success-popup .section-title {
        font-weight: bold;
        margin-bottom: 5px;
        font-size: 16px;
        color: #02a046;
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
    }
    .order-success-popup .info-item p {
        margin: 0 0 5px 0;
        line-height: 1.5;
        font-size: 14px;
    }
    .order-success-popup #recap-note-wrapper {
        margin-bottom: 2px;
    }
    .order-success-popup .order-items-recap .item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 3px;
        padding-bottom: ;
        border-bottom: 1px dashed #eee;
        font-size: 16px;
    }
    .order-success-popup .order-items-recap .item:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
    }
    .order-success-popup .total-recap {
        border-top: 2px dashed #ccc;
        margin: ; 
        padding-top: ; 
        text-align: right;
    }
    .order-success-popup .total-recap-label {
        font-size: 18px;
        color: #333;
        font-weight: bold;
    }
    .order-success-popup .total-recap-value {
        font-size: 20px;
        font-weight: bold;
        color: #027a48;
        margin-left: 10px;
    }
    @media (max-width: 768px) {
        .custom-alert.order-success-popup .custom-alert-content {
            width: 100%;
            height: 100%;
            max-height: 100%;
            border-radius: 0;
        }
        .custom-alert {
            padding: 0;
        }
    }
    /* --- End: New Success Popup Styles --- */
    .admin-popup { 
        position: fixed; 
        inset: 0; 
        background: rgba(0,0,0,.6); 
        display: none; 
        align-items: center; 
        justify-content: center; 
        z-index: 2000; 
        padding: 10px; 
    }
    .admin-popup-content { 
        background: #fff; 
        padding: 14px 15px; 
        border-radius: 12px; 
        width: 105%; 
        height: 92vh; 
        max-width: 768px; 
        display: flex; 
        flex-direction: column; 
        box-shadow: 0 10px 30px rgba(0,0,0,.2); 
    }
    .admin-header { 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        gap: 8px; 
        margin-bottom: 10px; 
    }
    .admin-header h2 { 
        margin: 0; 
        font-size: 18px;
        color: #02a046;
    }
    .admin-header button { 
        background: none; 
        border: none; 
        font-size: 18px; 
        cursor: pointer; 
        padding: 4px 6px; 
    }
    .admin-body { 
        flex: 1; 
        overflow-y: auto; 
    }
    .password-input-container {
        position: relative;
    }
    .password-input-container.checking input {
        border-color: #02a046;
        background: #f0fdf4;
    }
    .password-spinner {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 20px;
        border: 2px solid #e5e7eb;
        border-top: 2px solid #02a046;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        display: none;
    }
    .password-input-container.checking .password-spinner {
        display: block;
    }
    .menu-manager.disabled, .store-hours-manager.disabled, .order-manager.disabled { 
        opacity: .5; 
        pointer-events: none; 
    }
    .menu-item { 
        display: flex; 
        align-items: center; 
        justify-content: space-between; 
        gap: 10px; 
        padding: 6px 0; 
        border-bottom: 1px dashed #eee; 
    }
    .menu-name { 
        font-size: 16px; 
        line-height: 1.2; 
        font-weight: 600;
        color: #02a047;
    }
    .price { 
        color: #666; 
        font-size: 13px; 
    }
    .switch { 
        position: relative; 
        display: inline-block; 
        width: 50px; 
        height: 24px; 
    }
    .switch input { 
        display: none; 
    }
    .slider { 
        position: absolute; 
        cursor: pointer; 
        inset: 0; 
        background-color: red; 
        transition: .25s; 
        border-radius: 34px; 
    }
    .slider:before { 
        content: ""; 
        position: absolute; 
        height: 18px; 
        width: 18px; 
        left: 3px; 
        bottom: 3px; 
        background: #fff; 
        transition: .25s; 
        border-radius: 999px; 
        box-shadow: 0 1px 2px rgba(0,0,0,.2); 
    }
    input:checked + .slider { 
        background-color: #02a046; 
    }
    input:checked + .slider:before { 
        transform: translateX(26px); 
    }
    .admin-alert { 
        display: none; 
        padding: 8px 8px; 
        border-radius: 10px; 
        margin: 3px 0; 
        font-size: 14px; 
        border-left: 4px solid; 
        background: #f9fafb; 
    }
    .admin-alert.show { 
        display: block; 
    }
    .admin-alert.error { 
        color: #991b1b; 
        border-color: #d93025; 
        background: #fef2f2; 
    }
    .admin-alert.info { 
        color: #1f2937; 
        border-color: #93c5fd; 
        background: #eff6ff; 
    }
    .admin-alert.success { 
        color: #065f46; 
        border-color: #34d399; 
        background: #ecfdf5; 
    }
    .shop-info-item a {
        color: #02a046;
        text-decoration: none;
        font-weight: 600;
    }
    .shop-info-item a:hover {
        text-decoration: underline;
    }
    .custom-select-wrapper {
        position: relative;
    }
    .custom-dropdown {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        max-height: 300px;
        overflow-y: auto;
        z-index: 1000;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .dropdown-group {
        border-bottom: 1px solid #eee;
    }
    .dropdown-group:last-child {
        border-bottom: none;
    }
    .dropdown-group-label {
        background: #f8f9fa;
        padding: 8px 12px;
        font-weight: 600;
        font-size: 14px;
        color: #02a046;
        border-bottom: 1px solid #eee;
    }
    .dropdown-option {
        padding: 10px 12px;
        cursor: pointer;
        font-size: 13px;
        border-bottom: 1px solid #f0f0f0;
        transition: background-color 0.2s;
    }
    .dropdown-option:hover {
        background-color: #f0f8f4;
        color: #02a046;
    }
    .form-input[readonly] {
        cursor: pointer;
        background-color: #fff;
    }
    .store-hours-manager.disabled { 
        opacity: .5; 
        pointer-events: none; 
    }
    .hours-section {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 6px;
        margin: 3px 0;
    }
    .hours-section h4 {
        font-size: 13px;
    }
    .hour-range-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        margin: 5px 0;
        background: white;
    }
    .time-inputs {
        display: flex;
        align-items: center;
        gap: 8px;
        flex: 1;
    }
    .time-input {
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 4px 6px;
        width: 60px;
        text-align: center;
        font-size: 13px;
    }
    .time-separator {
        font-weight: bold;
        color: #02a046;
    }
    .delete-hour-btn {
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 4px 8px;
        cursor: pointer;
        font-size: 12px;
    }
    .delete-hour-btn:hover {
        background: #c82333;
    }
    .break-period-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px;
        border: 1px solid #ffc107;
        border-radius: 6px;
        margin: 5px 0;
        background: #fff8e1;
    }
    .break-info {
        flex: 1;
    }
    .break-dates {
        font-weight: 600;
        color: #333;
        font-size: 14px;
    }
    .break-reason {
        color: #666;
        font-size: 12px;
        margin-top: 2px;
    }
    .delete-break-btn {
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 4px 8px;
        cursor: pointer;
        font-size: 12px;
    }
    .delete-break-btn:hover {
        background: #c82333;
    }
    .store-status-popup {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        z-index: 10000;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }
    .store-status-popup.show {
        display: flex;
    }
    .store-status-content {
        background: white;
        border-radius: 15px;
        padding: 25px;
        max-width: 400px;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    .store-status-icon {
        font-size: 48px;
        margin-bottom: 15px;
    }
    .store-status-title {
        font-size: 20px;
        font-weight: bold;
        color: #dc3545;
        margin-bottom: 10px;
    }
    .store-status-message {
        font-size: 16px;
        line-height: 1.5;
        color: #333;
        margin-bottom: 20px;
    }
    .store-status-btn {
        background: #02a046;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 10px 20px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
    }
    .store-status-btn:hover {
        background: #018a3d;
    }
    .management-section {
        margin-top: 15px;
        border: 1px solid #e5e7eb;
        border-radius: 10px;
        background: #f9fafb;
    }
    .management-section details {
        border: none;
    }
    .management-section summary {
        font-weight: 600;
        font-size: 15px;
        color: #02a046;
        padding: 8px 12px;
        cursor: pointer;
        list-style: none;
        position: relative;
    }
    .management-section details[open] > summary {
        border-bottom: 1px solid #e5e7eb;
    }
    .management-section summary::-webkit-details-marker {
        display: none;
    }
    .management-section summary::after {
        content: '‚ñ∂';
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%) rotate(0deg);
        font-size: 12px;
        transition: transform 0.2s ease-in-out;
    }
    .management-section details[open] > summary::after {
        transform: translateY(-50%) rotate(90deg);
    }
    .management-section .details-content {
        padding: 1px 7px 7px;
        background: #fff;
        border-bottom-left-radius: 10px;
        border-bottom-right-radius: 10px;
    }
    .admin-body > hr {
        display: none;
    }
    .products-grid.store-closed .product-card:not(.disabled) .product-controls {
        pointer-events: none;
        opacity: 0.6;
    }
    .order-form {
        background: #f8f9fa;
        padding: 10px 10px 10px;
        border-radius: 12px;
        border-top: 1px solid #e0e0e0;
        margin-top: 8px;
    }
    .form-group {
        position: relative;
        margin-bottom: 8px;
    }
    .form-input, .form-textarea {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px; 
        padding: 10px 12px ;
        font-size: 16px;
        width: 100%;
    }
    .form-input:focus, .form-textarea:focus {
        outline: none;
        border-color: #02a046;
        box-shadow: 0 0 0 3px rgba(2, 160, 70, 0.1);
    }
    .form-label {
        position: absolute;
        top: 13px;
        left: 13px;
        font-size: 15px;
        color: #888;
        pointer-events: none;
        transition: all 0.2s ease-out;
        background-color: #fff;
        padding: 0 4px;
    }
    .form-input:focus ~ .form-label,
    .form-input:not(:placeholder-shown) ~ .form-label,
    .form-textarea:focus ~ .form-label,
    .form-textarea:not(:placeholder-shown) ~ .form-label {
        top: 0;
        transform: translateY(-50%);
        font-size: 12px;
        color: #02a046;
        font-weight: 600;
    }
    .form-input[readonly]:not(:placeholder-shown) ~ .form-label {
        top: 0;
        transform: translateY(-50%);
        font-size: 12px;
        color: #02a046;
        font-weight: 600;
    }
    .form-input.error {
        border-color: #dc3545;
    }
    .form-input.error:focus {
        box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
    }
    .form-input.error ~ .form-label {
        color: #dc3545;
    }
    .error-message {
        color: #dc3545;
        font-size: 13px;
        margin-top: 4px;
        padding-left: 5px;
        display: none;
    }
    .form-textarea {
        min-height: 40px;
        max-height: 40px;
    }
    .submit-btn {
    display: block;                  
    margin: -2px auto;              
    width: fit-content;              
    padding: 8px 13px;               
    font-size: 15px;
    background-color: #02a046;
    color: #fff;
    border-radius: 20px;
    border: 1px solid #ddd;
    font-weight: bold;
}
    .admin-shop-info-item {
        display: flex;
        align-items: baseline;
        padding: 4px 0;
        font-size: 15px;
        border-bottom: 1px solid #f0f0f0;
    }
    .admin-shop-info-item:last-child {
        border-bottom: none;
    }
    .admin-shop-info-item strong {
        color: #333;
        min-width: 100px;
        flex-shrink: 0;
    }
    .admin-shop-info-item a {
        color: #02a046;
        text-decoration: none;
        font-weight: 600;
    }
    .admin-shop-info-item a:hover {
        text-decoration: underline;
    }
    .order-card {
        background: #fff;
        border: 1px solid #02a046;
        border-left: 5px solid #02a046;
        border-radius: 8px;
        padding: 10px;
        margin-bottom: 10px;
    }
    .order-details p, .order-items {
        font-size: 14px;
    }
    .order-details p small {
        font-size: 12px;
    }
    .order-details p {
        margin: 0.5px 0;
       
        line-height: 1.3;
        color: #555;
    }
    .order-details p:first-child {
        margin-top: 0.5px;
    }
    .order-card.status-dang-giao { border-left-color: #a3cfbb; }
    .order-card.status-hoan-thanh { border-left-color: #198754; }
    .order-card.status-da-huy { border-left-color: #dc3545; opacity: 0.7; }
    .order-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start; /* Changed to flex-start for alignment */
        margin-bottom: 8px;
        padding-bottom: 6px;
        border-bottom: 1px dashed #eee;
    }
    .order-customer-info {
        flex: 1;
    }
    .customer-name-phone { 
        font-weight: bold; 
        font-size: 15px; 
        padding: 0.5px;
        color: #02a046;
    }
    .order-timestamp-customer {
        font-size: 16px;
        font-weight: normal;
        color: #555;
        margin-top: 1px;
    }
    .order-total { 
        font-weight: bold; 
        font-size: 15px; 
        color: #02a046; 
        margin-left: 10px; /* Add some space */
    }
    .order-details strong { color: #333; }
    .order-items {
        background: #f8f9fa;
        padding: 6px;
        border-radius: 6px;
        margin-top: 6px;
    }
    .order-actions {
        margin-top: 6px;
        
        
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .order-actions label {
        font-size: 14px;
    }
    .order-status-select {
        flex: 1;
        padding: 6px 8px;
        border-radius: 6px;
        border: 1px solid #02a046;
        font-size: 14px;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 0.5rem center;
        background-size: 1em;
        padding-right: 2rem;
    }
  
/* === START: NEW CODE FOR STATUS BACKGROUNDS === */
.order-card.status-cho-xac-nhan .order-status-select {
    background-color: #02a046;
    border-color: #02a046;
    color: white;
	font-weight: bold; 
}
.order-card.status-dang-giao .order-status-select {
    background-color: #d1e7dd; /* M√†u xanh l√° nh·∫°t cho d·ªÖ nh√¨n */
    border-color: #a3cfbb;
    color: #0a3622;
	font-weight: bold; 
}
.order-card.status-hoan-thanh .order-status-select {
    background-color: #e2e3e5; /* M√†u x√°m nh·∫°t */
    border-color: #d3d6d8;
    color: #41464b;
}
.order-card.status-da-huy .order-status-select {
    background-color: #f8d7da; /* M√†u ƒë·ªè nh·∫°t */
    border-color: #f1aeb5;
    color: #58151c;
}
/* === END: NEW CODE FOR STATUS BACKGROUNDS === */


    .admin-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        padding: 10px 0;
        margin-bottom: 20px;
    }
    .admin-card {
        background-color: #f8f9fa;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    .admin-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        border-color: #02a046;
    }
    .admin-card-icon {
        font-size: 36px;
        margin-bottom: 10px;
    }
    .admin-card-title {
        font-size: 14px;
        font-weight: 600;
        color: #333;
    }
    .management-view {
        display: none;
    }
    .back-to-grid-btn {
        background: #fff4cd;
        color: #02a046;
        border: none;
        padding: 8px 12px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 8px;
        margin-bottom: -5px;
        display: inline-block;
    }
    .back-to-grid-btn:hover {
        background: #ced4da;
    }
    .password-prompt {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.7);
        z-index: 3000;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 15px;
    }
    .password-prompt-content {
        background: #fff;
        padding: 25px;
        border-radius: 15px;
        text-align: center;
        width: 100%;
        max-width: 320px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    }
    .password-prompt-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
    }
    .password-prompt-subtitle {
        font-size: 14px;
        color: #666;
        margin-bottom: 20px;
    }
    .password-inputs {
        display: flex;
        gap: 10px;
        justify-content: center;
    }
    .password-inputs input {
        width: 45px;
        height: 55px;
        text-align: center;
        font-size: 24px;
        border: 1px solid #ccc;
        border-radius: 8px;
        outline: none;
        transition: all 0.2s;
        -moz-appearance: textfield;
    }
    .password-inputs input::-webkit-outer-spin-button,
    .password-inputs input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
    .password-inputs input:focus {
        border-color: #02a046;
        box-shadow: 0 0 0 3px rgba(2, 160, 70, 0.15);
    }
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
    }
    .password-prompt.shake .password-prompt-content {
        animation: shake 0.5s ease-in-out;
    }
    .password-close-btn {
        background: #f0f0f0;
        color: #333;
        border: none;
        padding: 8px 15px;
        border-radius: 20px;
        margin-top: 20px;
        cursor: pointer;
        font-weight: 500;
    }
    @media (max-width: 768px) {
        .admin-popup {
            padding: 0;
        }
        .admin-popup-content {
            width: 100%;
            height: 100%;
            border-radius: 0;
            padding: 10px;
        }
        .products-grid {
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        .product-image {
            margin: 1px;
            border-radius: 15px;
        }
        .product-name {
            font-size: 18px;
            height: 32px;
        }
        .product-price {
            font-size: 18px;
        }
        .add-btn {
            width: 30px;
            height: 30px;
            font-size: 18px;
        }
        .quantity-btn {
            width: 28px;
            height: 28px;
            font-size: 24px;
        }
        .quantity-display {
            font-size: 15px;
            min-width: 15px;
        }
        .cart-modal {
            padding: 2px !important;
        }
    }
    @media (min-width: 1024px) {
        .products-grid {
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }
    }
    @media (min-width: 769px) and (max-width: 1023px) {
        .products-grid {
            grid-template-columns: repeat(3, 1fr);
            gap: 14px;
        }
    }
</style>
</body>
</html>